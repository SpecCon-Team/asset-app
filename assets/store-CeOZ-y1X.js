import{a as o}from"./index-DvOGtWmT.js";import{o as s,s as i,e as d,b as k,a as g}from"./form-libs-D8_qC6eW.js";import{aB as T}from"./vendor-DIIGlvtc.js";const p=s({id:i(),email:i(),name:i().nullable().optional(),role:i().optional(),phone:i().nullable().optional(),isWhatsAppUser:k().optional(),createdAt:i().optional(),updatedAt:i().optional()}),y=s({id:i(),asset_code:i(),name:i(),status:i()}),c=s({id:i().optional(),number:i().optional(),title:i(),description:i().optional().nullable(),status:d(["open","in_progress","closed"]).default("open"),priority:d(["low","medium","high","critical"]).default("medium"),createdById:i().optional(),assignedToId:i().optional().nullable(),assetId:i().optional().nullable(),resolution:i().optional().nullable(),createdAt:i().optional(),updatedAt:i().optional(),createdBy:p.optional(),assignedTo:p.optional().nullable(),asset:y.optional().nullable()}),f=c.omit({id:!0,number:!0,createdAt:!0,updatedAt:!0,createdBy:!0,assignedTo:!0,asset:!0});f.partial();async function m(e){const a=new URLSearchParams;(e==null?void 0:e.limit)!==void 0?a.append("limit",e.limit.toString()):a.append("limit","-1"),(e==null?void 0:e.page)!==void 0&&a.append("page",e.page.toString());const t=await o().get(`/tickets?${a.toString()}`),r=Array.isArray(t.data)?t.data:t.data.data;return g(c).parse(r)}async function h(e){const a=await o().get(`/tickets/${e}`);return c.parse(a.data)}async function L(e){const a=await o().post("/tickets",e);return c.parse(a.data)}async function w(e,a){const t=await o().patch(`/tickets/${e}`,a);return c.parse(t.data)}async function b(e){await o().delete(`/tickets/${e}`)}const I=T(e=>({tickets:[],currentTicket:null,isLoading:!1,error:null,fetchTickets:async a=>{e({isLoading:!0,error:null});try{const t=await m(a);e({tickets:t,isLoading:!1})}catch(t){e({error:t.message,isLoading:!1})}},fetchTicketById:async a=>{e({isLoading:!0,error:null});try{const t=await h(a);e({currentTicket:t,isLoading:!1})}catch(t){e({error:t.message,isLoading:!1})}},createTicket:async a=>{e({isLoading:!0,error:null});try{const t=await L(a);return e(r=>({tickets:[...r.tickets,t],isLoading:!1})),t}catch(t){throw e({error:t.message,isLoading:!1}),t}},updateTicket:async(a,t)=>{e({isLoading:!0,error:null});try{const r=await w(a,t);return e(n=>{var l;return{tickets:n.tickets.map(u=>u.id===a?r:u),currentTicket:((l=n.currentTicket)==null?void 0:l.id)===a?r:n.currentTicket,isLoading:!1}}),r}catch(r){throw e({error:r.message,isLoading:!1}),r}},deleteTicket:async a=>{e({isLoading:!0,error:null});try{await b(a),e(t=>{var r;return{tickets:t.tickets.filter(n=>n.id!==a),currentTicket:((r=t.currentTicket)==null?void 0:r.id)===a?null:t.currentTicket,isLoading:!1}})}catch(t){throw e({error:t.message,isLoading:!1}),t}},clearCurrentTicket:()=>e({currentTicket:null})}));export{I as u};
