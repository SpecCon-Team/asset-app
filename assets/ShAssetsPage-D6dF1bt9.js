import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as I,r as a}from"./vendor-react-CFQdvhEG.js";import{u as D}from"./store-Ep1GRCvu.js";import{u as V,L as _,a as L}from"./index-BJREwX_9.js";import{C as M,g as F,e as O,A as H,d as P,a as R}from"./exportUtils-DRNWw7AS.js";import{C as $}from"./ConfirmDialog-CZXV2a2r.js";import"./index-BYClq9Tb.js";import{$ as U,V as z,Y,D as B,a0 as G,a1 as J,T as X,z as i}from"./vendor-ui-Bhgb65c8.js";import"./api-DZ-iU78O.js";import"./types-D8_qC6eW.js";function le(){const r=I(),[n,h]=a.useState(""),[l,u]=a.useState(""),[o,m]=a.useState(null),[b,c]=a.useState(!1),[f,g]=a.useState(!1),{assets:y,isLoading:j,error:p,fetchAssets:d,deleteAsset:k}=D(),N=V(j,2e3);a.useEffect(()=>{const s=localStorage.getItem("user");s&&JSON.parse(s).role!=="ADMIN"&&r("/my-assets")},[r]),a.useEffect(()=>{d({search:n,status:l})},[n,l,d]),a.useEffect(()=>{const s=()=>{document.visibilityState==="visible"&&d({search:n,status:l})};return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[n,l,d]);const t=y.filter(s=>!s.pegClientId||typeof s.pegClientId=="string"&&s.pegClientId.trim()===""),v=s=>{m(s)},w=async()=>{if(o){c(!0);try{await k(o),i.success("Asset deleted successfully"),m(null)}catch(s){console.error("Failed to delete asset:",s),i.error("Failed to delete asset")}finally{c(!1)}}},C=s=>{r(`/assets/${s}`)},S=()=>{try{const s=F("sh_assets_export","csv");O(t,H,s),i.success(`Exported ${t.length} SH assets to CSV`)}catch(s){console.error("Export failed:",s),i.error("Failed to export assets")}},A=()=>{try{P(R,"asset_import_template.csv"),i.success("Import template downloaded successfully")}catch(s){console.error("Template download failed:",s),i.error("Failed to download template")}},E=async s=>{const x=new FormData;x.append("file",s),localStorage.getItem("token");const T=(await L().post("/assets/import-csv",x,{headers:{"Content-Type":"multipart/form-data"}})).data;return await d({search:n,status:l}),T};return N?e.jsx(_,{message:"Loading SH assets..."}):p?e.jsxs("div",{className:"p-8 text-red-600 dark:text-red-400 bg-gray-50 dark:bg-gray-900 min-h-screen",children:["Error: ",p]}):e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 lg:p-8 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>r("/assets"),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Back to All Assets",children:e.jsx(U,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:"SH Assets Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Manage assets not assigned to PEG clients"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:flex lg:flex-wrap gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:A,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-purple-600 dark:bg-purple-500 text-white rounded-lg hover:bg-purple-700 dark:hover:bg-purple-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",title:"Download CSV template for bulk import",children:[e.jsx(z,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Template"})]}),e.jsxs("button",{onClick:()=>g(!0),className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",title:"Import assets from CSV",children:[e.jsx(Y,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Import CSV"})]}),e.jsxs("button",{onClick:S,disabled:t.length===0,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-green-600 dark:bg-green-500 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-600 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base min-h-[44px]",title:"Export SH assets to CSV",children:[e.jsx(B,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Export CSV"})]}),e.jsxs("button",{onClick:()=>r("/assets/new?returnTo=/assets/sh"),className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",children:[e.jsx("span",{children:"+"})," ",e.jsx("span",{className:"truncate",children:"Add Asset"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 md:mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm border-2",style:{borderColor:"#8D6E63"},children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total SH Assets"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-gray-900 dark:text-white",children:t.length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Available"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-green-600 dark:text-green-400",children:t.filter(s=>s.status==="available").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Assigned"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-blue-600 dark:text-blue-400",children:t.filter(s=>s.status==="assigned").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"In Service"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-orange-600 dark:text-orange-400",children:t.filter(s=>["maintenance","repair"].includes(s.status||"")).length})]})]}),e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search by name, code, or type...",value:n,onChange:s=>h(s.target.value),className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm sm:text-base min-h-[44px] dark:bg-gray-800 dark:text-white"}),e.jsxs("select",{value:l,onChange:s=>u(s.target.value),className:"px-3 sm:px-4 py-2 sm:py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm sm:text-base min-h-[44px] dark:bg-gray-800 dark:text-white sm:w-auto w-full",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"assigned",children:"Assigned"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"repair",children:"Repair"}),e.jsx("option",{value:"retired",children:"Retired"})]})]}),t.length===0?e.jsx("div",{className:"bg-white dark:bg-gray-800 p-8 sm:p-12 rounded-lg shadow text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No SH assets found"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5 md:gap-6",children:t.map(s=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-4 sm:p-5 md:p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3 sm:mb-4 gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg text-gray-900 dark:text-white truncate",children:s.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 truncate",children:s.asset_code})]}),e.jsx("span",{className:`px-2 sm:px-3 py-1 text-xs rounded-full whitespace-nowrap flex-shrink-0 ${s.status==="available"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.status==="assigned"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":s.status==="maintenance"||s.status==="repair"?"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:s.status})]}),e.jsxs("div",{className:"space-y-1.5 sm:space-y-2 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 w-20 sm:w-24 flex-shrink-0",children:"Type:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.asset_type||"-"})]}),e.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 w-20 sm:w-24 flex-shrink-0",children:"Condition:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.condition||"-"})]}),e.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 w-20 sm:w-24 flex-shrink-0",children:"Assigned to:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.assigned_to||"Unassigned"})]}),s.office_location&&e.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 w-20 sm:w-24 flex-shrink-0",children:"Location:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.office_location})]}),s.department&&e.jsxs("div",{className:"flex items-center text-xs sm:text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 w-20 sm:w-24 flex-shrink-0",children:"Department:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.department})]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 sm:pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{onClick:()=>C(s.id),className:"flex-1 px-2 sm:px-3 py-2 text-xs sm:text-sm bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded hover:bg-blue-100 dark:hover:bg-blue-900/50 flex items-center justify-center gap-1 sm:gap-2 transition-colors min-h-[40px]",children:[e.jsx(G,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"hidden xs:inline",children:"Edit"})]}),e.jsxs("button",{onClick:()=>r(`/assets/${s.id}`),className:"flex-1 px-2 sm:px-3 py-2 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center justify-center gap-1 sm:gap-2 transition-colors min-h-[40px]",children:[e.jsx(J,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"hidden xs:inline",children:"View"})]}),e.jsx("button",{onClick:()=>v(s.id),className:"px-2 sm:px-3 py-2 text-xs sm:text-sm bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded hover:bg-red-100 dark:hover:bg-red-900/50 flex items-center justify-center gap-1 sm:gap-2 transition-colors min-h-[40px]",children:e.jsx(X,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"})})]})]})},s.id))}),e.jsx($,{open:!!o,onClose:()=>m(null),onConfirm:w,title:"Delete Asset?",message:"Are you sure you want to delete this asset? This action cannot be undone.",confirmText:"Yes, delete it",cancelText:"Cancel",variant:"danger",isLoading:b}),e.jsx(M,{isOpen:f,onClose:()=>g(!1),onImport:E,title:"Import Assets from CSV",entityType:"assets"})]})}export{le as default};
