import{r as d,h as N,f as A,j as e,L as S,e as g}from"./index-BhngYsQ6.js";import{showError as T}from"./sweetalert-BCvQYi5m.js";const D=()=>{var h,y;const[r,u]=d.useState(null),[a,p]=d.useState(null),[i,k]=d.useState(null),[n,x]=d.useState(!0),j=N(n,2e3),[s,c]=d.useState({startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]});d.useEffect(()=>{m()},[]);const m=async()=>{try{x(!0);const t=A(),[l,w,f]=await Promise.all([t.get("/analytics/overview",{params:s}),t.get("/analytics/assets"),t.get("/analytics/tickets",{params:s})]);u(l.data),p(w.data),k(f.data)}catch(t){console.error("Error loading analytics:",t),T("Failed to load analytics")}finally{x(!1)}},o=t=>{const l=t==null||isNaN(t)?0:t;return new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(l)},b=t=>({open:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",in_progress:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200","in-progress":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200",closed:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",available:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",assigned:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",maintenance:"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200",repair:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200",retired:"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200",disposed:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",active:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",inactive:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",pending:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200",completed:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200"})[t.toLowerCase()]||"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",v=t=>({low:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200",medium:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",high:"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200",critical:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200",urgent:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200"})[t.toLowerCase()]||"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200";return j?e.jsx(S,{message:"Loading analytics data..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Advanced Analytics"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Comprehensive system insights and metrics"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:s.startDate,onChange:t=>c({...s,startDate:t.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:s.endDate,onChange:t=>c({...s,endDate:t.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsx("button",{onClick:m,disabled:n,className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors font-medium",children:n?"Loading...":"Apply"})]})}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Assets"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:r.overview.totalAssets})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Tickets"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:r.overview.totalTickets})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-green-600 dark:text-green-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:r.overview.totalUsers})]}),e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-purple-600 dark:text-purple-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Documents"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:r.overview.totalDocuments})]}),e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900 rounded-lg",children:e.jsx("svg",{className:"w-8 h-8 text-orange-600 dark:text-orange-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]})})]}),a&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Asset Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:o(a.totalValue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Depreciation"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:o(((h=a.depreciation)==null?void 0:h.total_depreciation)||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current Book Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:o(((y=a.depreciation)==null?void 0:y.total_value)||0)})]})]}),a.byStatus&&a.byStatus.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Assets by Status"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:a.byStatus.map(t=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${b(t.status)}`,children:t.status}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:t._count})]},t.status))})]})]}),i&&r&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ticket Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"By Status"}),e.jsx("div",{className:"space-y-2",children:r.distribution.ticketsByStatus.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${b(t.status)}`,children:t.status}),e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t._count})]},t.status))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"By Priority"}),e.jsx("div",{className:"space-y-2",children:r.distribution.ticketsByPriority.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${v(t.priority)}`,children:t.priority}),e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t._count})]},t.priority))})]})]}),i.avgResolutionTime!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average Resolution Time"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:[i.avgResolutionTime.toFixed(2)," hours"]})]})]}),r&&r.distribution.assetsByType.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Asset Types Distribution"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.distribution.assetsByType.map(t=>e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 border dark:border-blue-700 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t.asset_type}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:t._count})]},t.asset_type))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Data"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("a",{href:`${g()}/analytics/export?type=assets&format=csv`,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors shadow-sm",children:"Export Assets (CSV)"}),e.jsx("a",{href:`${g()}/analytics/export?type=tickets&format=csv`,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors shadow-sm",children:"Export Tickets (CSV)"}),e.jsx("a",{href:`${g()}/analytics/export?type=audit&format=csv`,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors shadow-sm",children:"Export Audit Logs (CSV)"})]})]})]})};export{D as default};
