import{u as S,a0 as R,r as l,h as Q,j as e,Q as n,P as o}from"./index-jwGniNUw.js";import{showSuccess as A,showError as f}from"./sweetalert-BCvQYi5m.js";import{Q as E}from"./index-sRd_s-Dw.js";import{A as T}from"./arrow-left-B4xv_lEm.js";import{S as j}from"./smartphone-DbUxluL6.js";import{C as b}from"./circle-check-big-CU7niLns.js";import{C as y}from"./circle-alert-JS463See.js";function L(){const a=S(),[x]=R(),[r,c]=l.useState(""),[m,h]=l.useState(!1),[s,i]=l.useState(null);l.useEffect(()=>{const t=x.get("qr");t&&(console.log("ðŸ“± QR code detected from URL:",t),c(t),p(t))},[x]);const p=async t=>{var g,u;if(t.trim())try{h(!0);const C=await Q().post("/checkout/qr/scan",{qrCode:t.trim()});i(C.data.asset),await A("Success!","QR code scanned successfully",1500)}catch(d){console.error("Failed to scan QR code:",d),await f("Error",((u=(g=d.response)==null?void 0:g.data)==null?void 0:u.message)||"Failed to scan QR code"),i(null)}finally{h(!1)}},w=async t=>{if(t.preventDefault(),!r.trim()){await f("Error","Please enter a QR code");return}await p(r.trim())},N=()=>{s&&a("/checkout/new",{state:{assetId:s.id}})},k=()=>{s&&a(`/assets/${s.id}`)},v=()=>{c(""),i(null)};return e.jsxs("div",{className:"flex flex-col p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>a("/checkout"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white mb-4",children:[e.jsx(T,{className:"w-5 h-5"}),"Back to Checkouts"]}),e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(n,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),"QR Code Scanner"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Scan QR codes with your phone camera or enter manually"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto w-full",children:[!s&&e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg shadow p-8 mb-6 border border-purple-200 dark:border-purple-800",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-purple-600 dark:bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Scan QR Code with Your Phone"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"The easiest way to scan QR codes is using your phone's camera. When you scan an asset QR code, it will automatically open this web app and process the scan!"}),e.jsxs("div",{className:"mt-6 p-6 bg-white dark:bg-gray-800 rounded-lg border-2 border-purple-300 dark:border-purple-700 shadow-lg",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Test QR Code"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Scan this QR code with your phone camera to test"})]}),e.jsx("div",{className:"flex justify-center p-4 bg-white dark:bg-gray-900 rounded-lg",children:e.jsx("div",{className:"bg-white p-6 rounded-lg border-2 border-gray-200 dark:border-gray-700 shadow-inner",children:e.jsx(E,{value:`${window.location.origin}${window.location.pathname}#/checkout/scan?qr=ASSET:TEST001:test-asset-id`,size:200,level:"H",includeMargin:!0,fgColor:"#000000",bgColor:"#FFFFFF"})})}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"This test QR code will open this page automatically when scanned!"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Generate real asset QR codes at ",e.jsx("span",{className:"font-mono text-purple-600 dark:text-purple-400",children:"/checkout/qr/generate"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-purple-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Open your phone's camera app"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Use the built-in camera app (not a third-party scanner)"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-purple-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Point at the QR code"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Position the QR code in the camera viewfinder"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-purple-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Tap the notification"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"When your phone detects the QR code, tap the notification to open the web app"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-purple-600 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:"4"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Automatic processing"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"The web app will automatically detect and process the QR code!"})]})]})]})]})]})}),!s&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5"}),"Or Enter QR Code Manually"]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Enter QR Code Data"}),e.jsx("input",{type:"text",value:r,onChange:t=>c(t.target.value),placeholder:"ASSET:CODE:ID or paste QR code data...",className:"w-full px-4 py-3 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 text-center text-lg font-mono",autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-center",children:"Format: ASSET:ASSET_CODE:ASSET_ID"})]}),e.jsx("button",{type:"submit",disabled:m||!r.trim(),className:"w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 transition-colors flex items-center justify-center gap-2 text-lg",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"w-5 h-5"}),"Scan QR Code"]})})]})]}),s&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Asset Found!"})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[s.image_url&&e.jsx("img",{src:s.image_url,alt:s.name,className:"w-24 h-24 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:s.name}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"w-4 h-4"}),e.jsxs("span",{children:["Code: ",s.asset_code]})]}),e.jsxs("p",{children:["Type: ",s.asset_type]}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.checkoutStatus==="available"?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),"Available"]}):e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),"Checked Out"]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[s.checkoutStatus==="available"?e.jsxs("button",{onClick:N,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(o,{className:"w-5 h-5"}),"Check Out This Asset"]}):e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-400 flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"This asset is currently checked out"]})}),e.jsxs("button",{onClick:k,className:"w-full px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(o,{className:"w-5 h-5"}),"View Asset Details"]}),e.jsxs("button",{onClick:v,className:"w-full px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(n,{className:"w-5 h-5"}),"Scan Another Code"]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-400 mb-3 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"How QR Codes Work"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-blue-800 dark:text-blue-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold",children:"1."}),e.jsx("span",{children:"QR codes contain a URL that points to this scanner page"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold",children:"2."}),e.jsx("span",{children:"When you scan with your phone camera, it detects the URL"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold",children:"3."}),e.jsx("span",{children:"Your phone opens the web app automatically"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold",children:"4."}),e.jsx("span",{children:"The QR code data is extracted and processed automatically"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-semibold",children:"5."}),e.jsx("span",{children:"Or manually enter/paste the QR code data in the input field above"})]})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("button",{onClick:()=>a("/checkout/qr/generate"),className:"text-purple-600 dark:text-purple-400 hover:underline text-sm font-medium",children:"Need to generate QR codes for your assets? Click here"})})]})]})}export{L as default};
