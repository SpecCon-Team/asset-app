import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as M,h as A,r as c}from"./vendor-react-CFQdvhEG.js";import{u as F,a as x,L as E,f as d}from"./index-D9yjAaPu.js";import{showConfirm as y,showSuccess as j,showError as p}from"./sweetalert-DcBwdyhg.js";import{z as B,W as b,$ as L,y as k,aI as R,T as P,f as o,an as I,U as q,u as z,a7 as U,w as H}from"./vendor-ui-Bhgb65c8.js";function G(){var h,u;const n=M(),{id:r}=A(),[t,N]=c.useState(null),[f,m]=c.useState(!0),v=F(f,2e3);c.useEffect(()=>{r&&g()},[r]);const g=async()=>{try{m(!0);const s=await x().get(`/maintenance/${r}`);N(s.data)}catch(a){console.error("Failed to fetch schedule:",a),B.error("Failed to load maintenance schedule")}finally{m(!1)}},w=async()=>{if((await y("Complete Maintenance?","Mark this maintenance task as completed?","Yes, complete it","Cancel")).isConfirmed)try{await x().post(`/maintenance/${r}/complete`,{status:"completed",notes:""}),await j("Success!","Maintenance task completed successfully"),g()}catch(s){console.error("Failed to complete maintenance:",s),await p("Error","Failed to complete maintenance task")}},C=async()=>{if((await y("Delete Schedule?","Are you sure you want to delete this maintenance schedule? This action cannot be undone.","Yes, delete it","Cancel")).isConfirmed)try{await x().delete(`/maintenance/${r}`),await j("Deleted!","Maintenance schedule deleted successfully"),n("/maintenance")}catch(s){console.error("Failed to delete maintenance schedule:",s),await p("Error","Failed to delete maintenance schedule")}},D=a=>{switch(a){case"critical":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"high":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"low":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}},S=a=>{const s=new Date,$=new Date(a),i=Math.ceil(($.getTime()-s.getTime())/(1e3*60*60*24));return i<0?{text:`Overdue by ${Math.abs(i)} days`,color:"text-red-600 dark:text-red-400",icon:H}:i===0?{text:"Due today",color:"text-orange-600 dark:text-orange-400",icon:o}:i<=7?{text:`Due in ${i} days`,color:"text-orange-600 dark:text-orange-400",icon:o}:{text:`Due in ${i} days`,color:"text-green-600 dark:text-green-400",icon:k}};if(v)return e.jsx(E,{message:"Loading maintenance schedule"});if(!t)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Schedule Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"The maintenance schedule you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>n("/maintenance"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Maintenance"})]});const l=S(t.nextDueDate),T=l.icon;return e.jsxs("div",{className:"flex flex-col p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>n("/maintenance"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white mb-4",children:[e.jsx(L,{className:"w-5 h-5"}),"Back to Maintenance"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(b,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),t.title]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:["Maintenance schedule for ",t.asset.name]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.isActive&&e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(k,{className:"w-5 h-5"}),"Complete"]}),e.jsxs("button",{onClick:()=>n(`/maintenance/${r}/edit`),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(R,{className:"w-5 h-5"}),"Edit"]}),e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(P,{className:"w-5 h-5"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Schedule Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Asset"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:t.asset.name}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.asset.asset_code," â€¢ ",t.asset.asset_type]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Schedule Type"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-white capitalize",children:[t.scheduleType,t.frequency&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 ml-2",children:["(",t.frequency,")"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Priority"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs rounded-full ${D(t.priority)}`,children:t.priority})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-3 py-1 text-xs rounded-full ${t.isActive?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}`,children:t.isActive?"Active":"Inactive"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Next Due Date"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx(T,{className:`w-4 h-4 ${l.color}`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900 dark:text-white",children:d(t.nextDueDate)}),e.jsx("div",{className:`text-xs ${l.color}`,children:l.text})]})]})]}),t.lastCompletedDate&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Last Completed"}),e.jsx("div",{className:"mt-1 text-gray-900 dark:text-white",children:d(t.lastCompletedDate)})]}),t.estimatedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Estimated Duration"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(o,{className:"w-4 h-4"}),t.estimatedDuration," minutes"]})]}),t.cost&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Estimated Cost"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"R",t.cost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Assigned To"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),((h=t.assignedTo)==null?void 0:h.name)||((u=t.assignedTo)==null?void 0:u.email)||"Unassigned"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Created By"}),e.jsx("div",{className:"mt-1 text-gray-900 dark:text-white",children:t.createdBy.name||t.createdBy.email})]})]}),t.description&&e.jsxs("div",{className:"mt-6 pt-6 border-t dark:border-gray-700",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Description"}),e.jsx("div",{className:"mt-2 text-gray-900 dark:text-white whitespace-pre-wrap",children:t.description})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-6 h-6"}),"Maintenance History (",t.history.length,")"]}),t.history.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No maintenance history yet"}):e.jsx("div",{className:"space-y-4",children:t.history.map(a=>e.jsxs("div",{className:"border dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":a.status==="failed"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400"}`,children:a.status}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:d(a.completedAt)})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Completed by ",a.completedBy.name||a.completedBy.email]})]}),e.jsxs("div",{className:"text-right text-sm",children:[a.actualDuration&&e.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:["Duration: ",a.actualDuration," min"]}),a.actualCost&&e.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:["Cost: R",a.actualCost.toFixed(2)]})]})]}),a.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Notes:"})," ",a.notes]}),a.issues&&e.jsxs("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:[e.jsx("strong",{children:"Issues:"})," ",a.issues]}),a.partsReplaced&&e.jsxs("div",{className:"mt-2 text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"Parts Replaced:"})," ",a.partsReplaced]})]},a.id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Completions"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.history.filter(a=>a.status==="completed").length})]}),t.history.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Cost"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:["R",t.history.reduce((a,s)=>a+(s.actualCost||0),0).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Time"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[t.history.reduce((a,s)=>a+(s.actualDuration||0),0)," min"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Created"}),e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:d(t.createdAt)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 border border-blue-200 dark:border-blue-800",children:[e.jsx(U,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 mb-3"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:"Next Maintenance"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mb-1",children:d(t.nextDueDate)}),e.jsx("div",{className:`text-sm ${l.color}`,children:l.text})]})]})]})]})}export{G as default};
