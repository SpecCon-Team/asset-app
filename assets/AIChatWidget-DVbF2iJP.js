import{r as s,j as e,as as A,b4 as b,b5 as E,b6 as z,X as $,U as T,T as H,b7 as R}from"./react-vendor-CLiifM8U.js";import{h as K,a as O}from"./index-DAo0lhFG.js";import"./export-libs-CrC4Cruk.js";import"./vendor-FPNzGmdA.js";function V(){const[o,f]=s.useState(!1),[i,S]=s.useState(!1),[a,l]=s.useState([]),[u,p]=s.useState(""),[m,w]=s.useState(!1),[y,h]=s.useState(!1),v=s.useRef(null),j=s.useRef(null),r=s.useRef(K()).current,x=`aiChatHistory_${r||"guest"}`,g=`aiChatWelcomeShown_${r||"guest"}`;s.useEffect(()=>{if(!r)return;const t=localStorage.getItem(x),n=localStorage.getItem(g);if(t){const c=JSON.parse(t);l(c.map(d=>({...d,timestamp:new Date(d.timestamp)})))}else l([]);h(!!n)},[]),s.useEffect(()=>{r&&a.length>0&&localStorage.setItem(x,JSON.stringify(a))},[a,r,x]),s.useEffect(()=>{var t;(t=v.current)==null||t.scrollIntoView({behavior:"smooth"})},[a]),s.useEffect(()=>{if(o&&!y&&a.length===0&&r){const t={id:Date.now().toString(),role:"assistant",content:`Hello! I'm your AI assistant for AssetTrack Pro. I can help you with:

• Managing your assets and tickets
• Troubleshooting issues
• Answering questions about the system
• Navigating features
• General support

How can I assist you today?`,timestamp:new Date};l([t]),h(!0),localStorage.setItem(g,"true")}},[o,y,a.length,r,g]),s.useEffect(()=>{var t;o&&!i&&((t=j.current)==null||t.focus())},[o,i]);const N=async()=>{if(!u.trim()||m)return;const t={id:Date.now().toString(),role:"user",content:u.trim(),timestamp:new Date};l(n=>[...n,t]),p(""),w(!0);try{const c=await O().post("/ai-chat",{message:t.content,history:a.slice(-10)}),d={id:(Date.now()+1).toString(),role:"assistant",content:c.data.reply,timestamp:new Date};l(D=>[...D,d])}catch(n){console.error("AI Chat error:",n);const c={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I'm having trouble connecting right now. Please try again in a moment or contact support if the issue persists.",timestamp:new Date};l(d=>[...d,c])}finally{w(!1)}},I=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),N())},k=()=>{l([]),h(!1),r&&(localStorage.removeItem(x),localStorage.removeItem(g))},C=()=>{f(!1),k()},M=t=>new Date(t).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return e.jsxs(e.Fragment,{children:[!o&&e.jsxs("button",{onClick:()=>f(!0),className:"fixed bottom-6 right-6 z-50 group","aria-label":"Open AI Chat",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full animate-ping opacity-75"}),e.jsx("div",{className:"relative bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-full shadow-2xl transition-all duration-300 transform group-hover:scale-110 p-4",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold animate-bounce",children:"AI"})]}),e.jsxs("div",{className:"absolute bottom-full right-0 mb-2 px-4 py-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap",children:[e.jsx("div",{className:"font-semibold",children:"Live Chat"}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Available 24/7"}),e.jsx("div",{className:"absolute top-full right-4 border-4 border-transparent border-t-white dark:border-t-gray-800"})]})]}),o&&e.jsx("div",{className:`fixed z-50 transition-all duration-300 ease-in-out
            ${i?"bottom-6 right-6 w-80":"bottom-6 right-6 w-96 h-[600px] md:w-[420px]"}
            max-w-[calc(100vw-3rem)] max-h-[calc(100vh-3rem)]
          `,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl flex flex-col h-full border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white/20 backdrop-blur-sm p-2 rounded-full",children:e.jsx(b,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"text-white",children:[e.jsx("div",{className:"font-semibold text-lg",children:"AI Assistant"}),e.jsxs("div",{className:"text-xs text-white/90 flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Available 24/7"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(!i),className:"p-2 hover:bg-white/20 rounded-lg transition-colors","aria-label":i?"Maximize":"Minimize",children:i?e.jsx(E,{className:"w-4 h-4 text-white"}):e.jsx(z,{className:"w-4 h-4 text-white"})}),e.jsx("button",{onClick:C,className:"p-2 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Close chat",children:e.jsx($,{className:"w-4 h-4 text-white"})})]})]}),!i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 dark:bg-gray-900",children:[a.map(t=>e.jsxs("div",{className:`flex gap-3 ${t.role==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${t.role==="user"?"bg-blue-600":"bg-gradient-to-r from-purple-600 to-blue-600"}`,children:t.role==="user"?e.jsx(T,{className:"w-4 h-4 text-white"}):e.jsx(b,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${t.role==="user"?"items-end":"items-start"}`,children:[e.jsx("div",{className:`rounded-2xl px-4 py-2 ${t.role==="user"?"bg-blue-600 text-white rounded-br-sm":"bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-700 rounded-bl-sm"}`,children:e.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:t.content})}),e.jsx("div",{className:`text-xs text-gray-500 dark:text-gray-400 mt-1 px-2 ${t.role==="user"?"text-right":"text-left"}`,children:M(t.timestamp)})]})]},t.id)),m&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-2xl rounded-bl-sm px-4 py-3",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]}),e.jsx("div",{ref:v})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-white dark:bg-gray-800",children:[a.length>1&&e.jsxs("button",{onClick:k,className:"text-xs text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 mb-2 flex items-center gap-1 transition-colors",children:[e.jsx(H,{className:"w-3 h-3"}),"Clear conversation"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{ref:j,value:u,onChange:t=>p(t.target.value),onKeyPress:I,placeholder:"Type your message...",rows:1,className:"flex-1 resize-none border border-gray-300 dark:border-gray-600 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 dark:bg-gray-700 dark:text-white text-sm max-h-32",disabled:m}),e.jsx("button",{onClick:N,disabled:!u.trim()||m,className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed text-white p-3 rounded-xl transition-all duration-200 transform hover:scale-105 disabled:hover:scale-100","aria-label":"Send message",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"Press Enter to send, Shift+Enter for new line"})]})]})]})})]})}export{V as default};
