import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{r as n}from"./vendor-react-CFQdvhEG.js";import{u as P,a as o,L as E}from"./index-DLjcbg9-.js";import{showError as l,showSuccess as p,showCustom as b}from"./sweetalert-DcBwdyhg.js";import{b as T,aG as y,f as S,q as c,D as j,w as L,T as Y}from"./vendor-ui-Bhgb65c8.js";function U(){var x,u,h,g;const[i,f]=n.useState(null),[w,N]=n.useState(!0),k=P(w,2e3),[d,m]=n.useState(!1);n.useEffect(()=>{v()},[]);const v=async()=>{try{const s=await o().get("/gdpr/retention-summary");f(s.data)}catch(s){console.error("Failed to fetch retention summary:",s),l("Error","Failed to load privacy data")}finally{N(!1)}},R=async()=>{try{m(!0);const s=await o().get("/gdpr/export",{responseType:"blob"}),t=new Blob([s.data],{type:"application/json"}),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`user-data-export-${Date.now()}.json`,r.click(),window.URL.revokeObjectURL(a),p("Success!","Your data has been exported successfully")}catch(s){console.error("Export error:",s),l("Error","Failed to export your data")}finally{m(!1)}},D=async()=>{try{const t=(await o().get("/gdpr/privacy-report")).data;b({title:"Privacy Report",html:`
          <div class="text-left">
            <h3 class="font-semibold mb-2">Data Processing</h3>
            <p class="text-sm mb-2"><strong>Purposes:</strong></p>
            <ul class="text-sm list-disc pl-5 mb-4">
              ${t.dataProcessing.purposes.map(a=>`<li>${a}</li>`).join("")}
            </ul>

            <p class="text-sm mb-2"><strong>Legal Basis:</strong> ${t.dataProcessing.legalBasis}</p>
            <p class="text-sm mb-4"><strong>Retention:</strong> ${t.dataProcessing.dataRetention}</p>

            <h3 class="font-semibold mb-2">Your Rights</h3>
            <ul class="text-sm list-disc pl-5 mb-4">
              <li>${t.yourRights.rightToAccess}</li>
              <li>${t.yourRights.rightToRectification}</li>
              <li>${t.yourRights.rightToErasure}</li>
              <li>${t.yourRights.rightToDataPortability}</li>
            </ul>

            <h3 class="font-semibold mb-2">Security</h3>
            <ul class="text-sm list-disc pl-5">
              <li>${t.security.encryption}</li>
              <li>Two-Factor Auth: ${t.security.twoFactorAuth}</li>
              <li>Access Control: ${t.security.accessControl}</li>
            </ul>
          </div>
        `,width:"600px",confirmButtonText:"Close"})}catch(s){console.error("Privacy report error:",s),l("Error","Failed to generate privacy report")}},A=async()=>{(await b({title:"Anonymize Your Account?",html:`
        <div class="text-left mb-4">
          <p class="mb-2"><strong>This action will:</strong></p>
          <ul class="list-disc pl-5 text-sm mb-4">
            <li>Remove your email, name, phone, and profile picture</li>
            <li>Replace them with anonymized values</li>
            <li>Disable your account for login</li>
            <li>Keep your tickets and comments for business records</li>
          </ul>
          <p class="text-red-600 font-semibold">⚠️ This action cannot be undone!</p>
        </div>
      `,input:"password",inputLabel:"Enter your password to confirm",inputPlaceholder:"Password",showCancelButton:!0,confirmButtonColor:"#EF4444",confirmButtonText:"Anonymize My Account",cancelButtonText:"Cancel",preConfirm:async t=>{var a,r;if(!t)return{isConfirmed:!1,error:"Password is required"};try{return await o().post("/gdpr/anonymize",{password:t,confirmation:"I understand this action cannot be undone"}),{isConfirmed:!0}}catch(C){return{isConfirmed:!1,error:((r=(a=C.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to anonymize account"}}}})).isConfirmed&&p("Account Anonymized","Your account has been anonymized. You will be logged out now.",3e3).then(()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),window.location.href="/login"})};return k?e.jsx(E,{message:"Loading privacy dashboard..."}):e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(T,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Privacy & Data Management"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your personal data, privacy settings, and exercise your GDPR rights"})]}),i&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Your Data Summary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Account Age"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i.accountAgeDays," days"]})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[e.jsx(c,{className:"w-5 h-5 text-green-600 dark:text-green-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tickets Created"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((u=(x=i.dataCategories)==null?void 0:x.activityData)==null?void 0:u.ticketsCreated)||0})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:[e.jsx(y,{className:"w-5 h-5 text-purple-600 dark:text-purple-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Assets Owned"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:((g=(h=i.dataCategories)==null?void 0:h.assetData)==null?void 0:g.assetsOwned)||0})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(j,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Export Your Data"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Download a complete copy of your personal data in JSON format. This includes your profile, tickets, comments, and activity history."}),e.jsx("button",{onClick:R,disabled:d,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"sr-only",children:"Exporting"})]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"Export Data (JSON)"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(c,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Privacy Report"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"View detailed information about how your data is processed, stored, and protected. Learn about your privacy rights."}),e.jsxs("button",{onClick:D,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(c,{className:"w-5 h-5"}),e.jsx("span",{children:"View Privacy Report"})]})]})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg shadow-md p-6 border border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(L,{className:"w-6 h-6 text-red-600 dark:text-red-400"}),e.jsx("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-300",children:"Danger Zone"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-red-900 dark:text-red-300 mb-2",children:"Anonymize Your Account"}),e.jsx("p",{className:"text-sm text-red-800 dark:text-red-400 mb-4",children:'This will remove all your personal information (name, email, phone) and replace them with anonymized values. Your tickets and comments will remain for business records, but will show as "Deleted User". This action is permanent and cannot be undone.'}),e.jsxs("button",{onClick:A,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{children:"Anonymize My Account"})]})]}),e.jsx("div",{className:"bg-red-100 dark:bg-red-900/40 rounded-lg p-4 mt-4",children:e.jsxs("p",{className:"text-xs text-red-800 dark:text-red-300",children:[e.jsx("strong",{children:"Note:"})," Account anonymization complies with GDPR Article 17 (Right to Erasure). Your activity records are retained for legal and business purposes but cannot be linked back to you."]})})]}),e.jsxs("div",{className:"mt-6 bg-gray-100 dark:bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Your Privacy Rights Under GDPR"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to Access:"})," You can export your data anytime"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to Rectification:"})," You can update your profile information"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to Erasure:"})," You can request account anonymization"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to Data Portability:"})," Download your data in a machine-readable format"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-1",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Right to Object:"})," Contact your administrator to object to data processing"]})]})]})]})]})}export{U as default};
