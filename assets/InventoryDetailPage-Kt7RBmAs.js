import{u as C,n as S,r as d,i as T,h as g,j as e,L as P,P as D,m as I,T as L,a1 as _}from"./index-d-W5hbHG.js";import{showError as m,showConfirm as A,showSuccess as p}from"./sweetalert-BCvQYi5m.js";import{A as E}from"./arrow-left-1UO6co1x.js";import{D as F}from"./dollar-sign-CAI15ImJ.js";import{M as q}from"./map-pin-VvKGPs5w.js";import{C as $}from"./circle-alert-CYXU3aQO.js";import{P as B}from"./plus-JMf6TQSG.js";import{S as M}from"./square-pen-wJH-QsdF.js";function J(){const c=C(),{id:i}=S(),[j,h]=d.useState(!0),b=T(j,2e3),[t,k]=d.useState(null),[u,x]=d.useState(!1),[r,o]=d.useState({transactionType:"purchase",quantity:"",unitPrice:"",notes:""});d.useEffect(()=>{i&&y()},[i]);const y=async()=>{try{h(!0);const s=await g().get(`/inventory/${i}`);k(s.data)}catch(a){console.error("Failed to fetch item:",a),await m("Error","Failed to load inventory item"),c("/inventory")}finally{h(!1)}},N=async()=>{var s,l;if((await A("Delete Item","Are you sure you want to delete this inventory item? This action cannot be undone.","Delete","Cancel")).isConfirmed)try{await g().delete(`/inventory/${i}`),await p("Success!","Inventory item deleted successfully",1500),c("/inventory")}catch(n){console.error("Failed to delete item:",n),await m("Error",((l=(s=n.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to delete inventory item")}},f=async a=>{var s,l;a.preventDefault();try{await g().post(`/inventory/${i}/transaction`,r),await p("Success!","Stock transaction recorded successfully",1500),x(!1),o({transactionType:"purchase",quantity:"",unitPrice:"",notes:""}),y()}catch(n){console.error("Failed to create transaction:",n),await m("Error",((l=(s=n.response)==null?void 0:s.data)==null?void 0:l.message)||"Failed to record transaction")}};if(b||!t)return e.jsx(P,{message:"Loading inventory item details"});const w=a=>{switch(a){case"out_of_stock":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"reorder_now":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";case"low_stock":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400"}},v=a=>["purchase","adjustment_in","return"].includes(a)?e.jsx(L,{className:"w-4 h-4 text-green-600"}):e.jsx(_,{className:"w-4 h-4 text-red-600"});return e.jsxs("div",{className:"flex flex-col p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>c("/inventory"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white mb-4",children:[e.jsx(E,{className:"w-5 h-5"}),"Back to Inventory"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(D,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),t.name]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:[t.itemCode," â€¢ ",t.category]})]}),e.jsx("span",{className:`px-4 py-2 rounded-lg text-sm font-semibold ${w(t.stockStatus)}`,children:t.stockStatus.replace("_"," ").toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Item Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Item Code"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:t.itemCode})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Category"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.category})]}),t.subcategory&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Subcategory"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.subcategory})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Unit"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.unit})]}),t.unitPrice&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),"Unit Price"]}),e.jsxs("p",{className:"text-gray-900 dark:text-white",children:["$",t.unitPrice]})]}),t.location&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(q,{className:"w-4 h-4"}),"Location"]}),e.jsxs("p",{className:"text-gray-900 dark:text-white",children:[t.location,t.binLocation&&` - ${t.binLocation}`]})]}),t.manufacturer&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Manufacturer"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.manufacturer})]}),t.barcode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Barcode"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-mono",children:t.barcode})]}),t.description&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Description"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.description})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Stock Levels"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.currentStock}),e.jsx("p",{className:"text-xs text-gray-500",children:t.unit})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Minimum"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:t.minimumStock}),e.jsx("p",{className:"text-xs text-gray-500",children:t.unit})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Reorder Point"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:t.reorderPoint}),e.jsx("p",{className:"text-xs text-gray-500",children:t.unit})]}),t.maximumStock&&e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Maximum"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.maximumStock}),e.jsx("p",{className:"text-xs text-gray-500",children:t.unit})]})]}),t.currentStock<=t.reorderPoint&&e.jsx("div",{className:"mt-4 p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-400 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Stock is at or below reorder point. Consider ordering ",t.reorderQuantity," ",t.unit,"."]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Transaction History"}),t.transactions&&t.transactions.length>0?e.jsx("div",{className:"space-y-3",children:t.transactions.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[v(a.transactionType),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium capitalize",children:a.transactionType.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["By ",a.performedBy.name||a.performedBy.email]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(a.transactionDate).toLocaleString()}),a.notes&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.notes})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[["purchase","adjustment_in","return"].includes(a.transactionType)?"+":"-",a.quantity]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Balance: ",a.balanceAfter]})]})]},a.id))}):e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No transactions yet"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>x(!u),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"New Transaction"]}),e.jsxs("button",{onClick:()=>c(`/inventory/${i}/edit`),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),"Edit Item"]}),e.jsxs("button",{onClick:N,className:"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Delete Item"]})]})]}),u&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Record Transaction"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type"}),e.jsxs("select",{value:r.transactionType,onChange:a=>o({...r,transactionType:a.target.value}),className:"w-full px-4 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"purchase",children:"Purchase"}),e.jsx("option",{value:"issue",children:"Issue"}),e.jsx("option",{value:"adjustment_in",children:"Adjustment In"}),e.jsx("option",{value:"adjustment_out",children:"Adjustment Out"}),e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"waste",children:"Waste"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quantity"}),e.jsx("input",{type:"number",required:!0,min:"1",value:r.quantity,onChange:a=>o({...r,quantity:a.target.value}),className:"w-full px-4 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:a=>o({...r,notes:a.target.value}),rows:3,className:"w-full px-4 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Record"})]})]})]})]})]})]})}export{J as default};
