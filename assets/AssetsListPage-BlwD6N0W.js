import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as A,r as a}from"./vendor-react-CFQdvhEG.js";import{u as S}from"./store-DH0YfdBd.js";import{u as I,L as T,a as E}from"./index-Cx7pohAz.js";import{C as D,g as M,e as V,A as O,d as F,a as L}from"./exportUtils-DRNWw7AS.js";import{C as _}from"./ConfirmDialog-avgzo7hr.js";import"./index-BYClq9Tb.js";import{V as P,Y as R,D as U,z as r}from"./vendor-ui-Bhgb65c8.js";import{A as z}from"./AssignAssetsToClientModal-4truyEUs.js";import"./api-CxCAJem_.js";import"./types-D8_qC6eW.js";import"./sweetalert-DcBwdyhg.js";function se(){const o=A(),[n,d]=a.useState(null),[h,m]=a.useState(!1),[u,x]=a.useState(!1),[b,c]=a.useState(!1),{assets:t,isLoading:f,error:g,fetchAssets:l,deleteAsset:y}=S(),j=I(f,2e3);a.useEffect(()=>{const s=localStorage.getItem("user");s&&JSON.parse(s).role!=="ADMIN"&&o("/my-assets")},[o]),a.useEffect(()=>{l({})},[l]);const N=async()=>{if(n){m(!0);try{await y(n),r.success("Asset deleted successfully"),d(null)}catch(s){console.error("Failed to delete asset:",s),r.error("Failed to delete asset")}finally{m(!1)}}},k=()=>{try{const s=M("assets_export","csv");V(t,O,s),r.success(`Exported ${t.length} assets to CSV`)}catch(s){console.error("Export failed:",s),r.error("Failed to export assets")}},w=()=>{try{F(L,"asset_import_template.csv"),r.success("Import template downloaded successfully")}catch(s){console.error("Template download failed:",s),r.error("Failed to download template")}},C=async s=>{const i=new FormData;i.append("file",s),localStorage.getItem("token");const v=(await E().post("/assets/import-csv",i,{headers:{"Content-Type":"multipart/form-data"}})).data;return await l({}),v},p=s=>{o(s==="peg"?"/assets/peg":"/assets/sh")};return j?e.jsx(T,{message:"Loading assets..."}):g?e.jsx("div",{className:"p-8 bg-gray-50 dark:bg-gray-900 min-h-screen",children:e.jsxs("div",{className:"max-w-2xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Error Loading Assets"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:g}),e.jsx("button",{onClick:()=>l({}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})]})}):e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 lg:p-8 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:"Asset Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Manage, assign, and track all assets"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:flex lg:flex-wrap gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:w,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-purple-600 dark:bg-purple-500 text-white rounded-lg hover:bg-purple-700 dark:hover:bg-purple-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",title:"Download CSV template for bulk import",children:[e.jsx(P,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Template"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",title:"Import assets from CSV",children:[e.jsx(R,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Import CSV"})]}),e.jsxs("button",{onClick:k,disabled:t.length===0,className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-green-600 dark:bg-green-500 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-600 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base min-h-[44px]",title:"Export assets to CSV",children:[e.jsx(U,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Export CSV"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"px-3 sm:px-4 py-2 sm:py-2.5 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base min-h-[44px]",children:[e.jsx("span",{children:"+"})," ",e.jsx("span",{className:"truncate",children:"Add Client Assets"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 md:mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Assets"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-gray-900 dark:text-white",children:t.length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Available"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-green-600 dark:text-green-400",children:t.filter(s=>s.status==="available").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Assigned"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-blue-600 dark:text-blue-400",children:t.filter(s=>s.status==="assigned").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"In Service"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-orange-600 dark:text-orange-400",children:t.filter(s=>["maintenance","repair"].includes(s.status||"")).length})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 md:mb-8",children:[e.jsx("button",{onClick:()=>p("peg"),className:"p-3 sm:p-4 md:p-6 rounded-lg border-2 transition-all hover:scale-105 hover:shadow-lg bg-white dark:bg-gray-800 cursor-pointer text-left w-full",style:{borderColor:"#FF9800"},children:e.jsxs("div",{className:"text-center w-full",children:[e.jsx("div",{className:"text-sm sm:text-base md:text-lg font-bold mb-1 sm:mb-2 whitespace-nowrap",style:{color:"#FF9800"},children:"PEG Assets"}),e.jsx("div",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 text-gray-900 dark:text-white",children:t.filter(s=>s.pegClientId).length}),e.jsx("div",{className:"text-xs sm:text-sm opacity-90 text-gray-600 dark:text-gray-400",children:t.filter(s=>s.pegClientId).length===1?"Asset":"Assets"}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Click to manage"})]})}),e.jsx("button",{onClick:()=>p("sh"),className:"p-3 sm:p-4 md:p-6 rounded-lg border-2 transition-all hover:scale-105 hover:shadow-lg bg-white dark:bg-gray-800 cursor-pointer text-left w-full",style:{borderColor:"#8D6E63"},children:e.jsxs("div",{className:"text-center w-full",children:[e.jsx("div",{className:"text-sm sm:text-base md:text-lg font-bold mb-1 sm:mb-2 whitespace-nowrap",style:{color:"#8D6E63"},children:"SH Assets"}),e.jsx("div",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 text-gray-900 dark:text-white",children:t.filter(s=>!s.pegClientId).length}),e.jsx("div",{className:"text-xs sm:text-sm opacity-90 text-gray-600 dark:text-gray-400",children:t.filter(s=>!s.pegClientId).length===1?"Asset":"Assets"}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Click to manage"})]})})]}),e.jsx(_,{open:!!n,onClose:()=>d(null),onConfirm:N,title:"Delete Asset?",message:"Are you sure you want to delete this asset? This action cannot be undone.",confirmText:"Yes, delete it",cancelText:"Cancel",variant:"danger",isLoading:h}),e.jsx(D,{isOpen:u,onClose:()=>x(!1),onImport:C,title:"Import Assets from CSV",entityType:"assets"}),e.jsx(z,{isOpen:b,onClose:()=>c(!1),onSuccess:()=>{l({})}})]})}export{se as default};
