import{r as a,h as y,H as u,e as g,j as e,L as k,z as l}from"./index-BcZKc_gk.js";import{C as N}from"./circle-check-big-CsSySIiX.js";import{C as w}from"./circle-alert-DXFaWjr-.js";import{M as A}from"./message-circle-HNB0VCSZ.js";function I(){const[r,p]=a.useState(""),[t,c]=a.useState(!1),[o,d]=a.useState(!1),[h,x]=a.useState(!0),b=y(h,2e3);a.useEffect(()=>{j()},[]);const j=async()=>{x(!0);try{const s=localStorage.getItem("token"),n=await u.get(`${g()}/whatsapp/status`,{headers:{Authorization:`Bearer ${s}`}});c(n.data.configured)}catch(s){console.error("Failed to check WhatsApp status:",s),c(!1)}finally{x(!1)}},f=async()=>{var s,n;if(!r){l.error("Please enter a phone number to test");return}d(!0);try{const i=localStorage.getItem("token"),m=await u.post(`${g()}/whatsapp/test`,{phoneNumber:r},{headers:{Authorization:`Bearer ${i}`}});m.data.success?(l.success("Test message sent successfully! Check your WhatsApp."),c(!0)):l.error(m.data.error||"Failed to send test message")}catch(i){console.error("Failed to send test message:",i),l.error(((n=(s=i.response)==null?void 0:s.data)==null?void 0:n.error)||"Failed to send test message")}finally{d(!1)}};return b?e.jsx(k,{message:"Checking WhatsApp status..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"WhatsApp Setup"}),e.jsx("p",{className:"text-gray-600",children:"Configure WhatsApp Business API for notifications"})]}),e.jsx("div",{className:`border rounded-lg p-6 ${t?"bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-700":"bg-yellow-50 dark:bg-yellow-900/30 border-yellow-200 dark:border-yellow-700"}`,children:e.jsx("div",{className:"flex items-center gap-3",children:t?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 dark:text-green-100",children:"WhatsApp Connected"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"Your WhatsApp Business account is active"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-900 dark:text-yellow-100",children:"WhatsApp Not Connected"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Configure your WhatsApp Business API to enable notifications"})]})]})})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 dark:text-white",children:"WhatsApp Business API Configuration"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Current Configuration"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800 dark:text-blue-200",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Phone Number ID:"})," ",t?"852483691285659":"Not configured"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Business Account ID:"})," ",t?"1554902325693975":"Not configured"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",h?"Checking...":t?"✅ Connected":"❌ Not Connected"]})]})]}),e.jsxs("div",{className:"border-t dark:border-gray-700 pt-6",children:[e.jsx("h3",{className:"font-semibold mb-4 dark:text-white",children:"Test WhatsApp Connection"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Send a test message to verify your WhatsApp Business API is working correctly."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 dark:text-gray-300",children:"Test Phone Number"}),e.jsx("input",{type:"tel",value:r,onChange:s=>p(s.target.value),placeholder:"+27712919486",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Include country code (e.g., +27 for South Africa)"})]}),e.jsxs("button",{onClick:f,disabled:o||!r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),o?"Sending...":"Send Test Message"]})]})]})]})]}),t&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 dark:text-white",children:"Notification Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium dark:text-white",children:"New Ticket Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Send WhatsApp message when a new ticket is created"})]})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium dark:text-white",children:"Ticket Assignment Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Notify users when they're assigned to a ticket"})]})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium dark:text-white",children:"Comment Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Alert users when someone comments on their ticket"})]})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium dark:text-white",children:"Status Change Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Notify when ticket status changes"})]})]})]}),e.jsx("p",{className:"mt-6 text-sm text-gray-500 dark:text-gray-400 italic",children:"Note: These notification settings will be functional once WhatsApp integration is fully configured in your backend."})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Setup Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("li",{children:"Create a WhatsApp Business account at business.whatsapp.com"}),e.jsx("li",{children:"Get your API credentials from the WhatsApp Business dashboard"}),e.jsx("li",{children:"Enter your phone number and API key above"}),e.jsx("li",{children:"Configure webhook URL for receiving messages (optional)"}),e.jsx("li",{children:"Test the connection by sending a test message"}),e.jsx("li",{children:"Enable notification types you want to use"})]})]})]})}export{I as default};
