import{r as l,j as e}from"./react-vendor-CGeGxK2Z.js";import{u as pe}from"./store-SoO7QIpB.js";import{l as he}from"./api-rDdjcoD9.js";import{u as ue,a as L,L as be,f as ee}from"./index-C4sdeoft.js";import{showSuccess as V,showError as $,showThemedAlert as O,showConfirmation as ye}from"./sweetalert-BqYQyfQ6.js";import{C as fe,g as we,e as je,T as ke,d as Ne,b as ve}from"./exportUtils-DXnFpLbV.js";import{aB as Ce,az as E}from"./vendor-U4Kn3po4.js";import"./qrcode-libs-D_7RQtxY.js";import{a0 as Se,a1 as Te,U as Ie,a2 as De,a3 as Pe,a4 as Ae,J as Me,V as Le,Y as Ee,D as Ue,a5 as Be,a6 as Fe}from"./ui-libs-t3PztYli.js";import{u as Ve}from"./react-router-vendor-DDwJJgaM.js";import"./export-libs-_UL_8v9K.js";import"./form-libs-D8_qC6eW.js";function $e({tickets:y,onStatusChange:o,onTicketClick:S}){const[c,j]=l.useState(!1),x=[{id:"open",title:"Open",status:"open",color:"#3B82F6"},{id:"in_progress",title:"In Progress",status:"in_progress",color:"#EAB308",limit:5},{id:"closed",title:"Closed",status:"closed",color:"#6B7280"}],k=l.useMemo(()=>{const t={};return x.forEach(r=>{t[r.status]=y.filter(d=>d.status===r.status)}),t},[y,x]),p=async t=>{const{destination:r,source:d,draggableId:h}=t;if(!r||r.droppableId===d.droppableId&&r.index===d.index)return;const u=r.droppableId,g=x.find(f=>f.status===u);if(g!=null&&g.limit&&k[u].length>=g.limit){alert(`WIP limit reached for ${g.title} (max ${g.limit})`);return}j(!0);try{await o(h,u)}catch(f){console.error("Failed to update ticket status:",f),alert("Failed to update ticket status")}finally{j(!1)}},T=(t,r)=>t?t.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2):r.slice(0,2).toUpperCase(),I=l.memo(({ticket:t,index:r,onTicketClick:d})=>e.jsx(Se,{draggableId:t.id,index:r,isDragDisabled:c,children:(h,u)=>e.jsxs("div",{ref:h.innerRef,...h.draggableProps,...h.dragHandleProps,onClick:()=>d(t.id),className:`bg-white dark:bg-gray-800 rounded-lg md:rounded-xl p-3 sm:p-4 border border-gray-200 dark:border-gray-700 hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200 cursor-grab active:cursor-grabbing ${u.isDragging?"rotate-2 sm:rotate-3 shadow-2xl scale-105 ring-2 ring-blue-500":"shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 pb-2 border-b border-gray-100 dark:border-gray-700",children:[e.jsx("span",{className:"text-[10px] sm:text-xs font-mono font-semibold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded",children:t.number}),e.jsx("div",{className:"flex items-center gap-1 sm:gap-2",children:e.jsxs("div",{className:`flex items-center gap-1 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium ${t.priority==="urgent"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.priority==="high"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":t.priority==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:[e.jsx(Te,{className:"w-2.5 h-2.5 sm:w-3 sm:h-3"}),e.jsx("span",{className:"hidden sm:inline",children:t.priority})]})})]}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1.5 sm:mb-2 line-clamp-2 text-xs sm:text-sm",children:t.title}),t.description&&e.jsx("p",{className:"text-[11px] sm:text-xs text-gray-600 dark:text-gray-400 mb-2 sm:mb-3 line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between pt-2 sm:pt-3 border-t border-gray-100 dark:border-gray-700",children:[t.assignedTo?e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-[10px] sm:text-xs font-bold shadow-sm",children:T(t.assignedTo.name,t.assignedTo.email)}),e.jsx("span",{className:"text-[10px] sm:text-xs text-gray-700 dark:text-gray-300 font-medium hidden lg:inline truncate max-w-[100px]",children:t.assignedTo.name||t.assignedTo.email.split("@")[0]})]}):e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 text-gray-400 dark:text-gray-500",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(Ie,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx("span",{className:"text-[10px] sm:text-xs hidden lg:inline",children:"Unassigned"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(De,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline truncate",children:Ce(new Date(t.createdAt),{addSuffix:!0})})]})]})]})},t.id));return e.jsx("div",{className:"w-full h-full flex flex-col bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 rounded-lg md:rounded-xl p-3 sm:p-4 md:p-6",children:e.jsx(Pe,{onDragEnd:p,children:e.jsx("div",{className:"flex-1 overflow-x-auto w-full",children:e.jsx("div",{className:"flex gap-3 sm:gap-4 md:gap-6 h-full min-h-[500px] sm:min-h-[600px] w-max md:w-full",children:x.map(t=>{const r=k[t.status]||[],d=t.limit&&r.length>t.limit;return e.jsxs("div",{className:"flex-shrink-0 w-[280px] sm:w-[320px] md:flex-1 md:min-w-[320px] flex flex-col",children:[e.jsx("div",{className:"mb-3 sm:mb-4 bg-white dark:bg-gray-800 rounded-lg p-3 sm:p-4 shadow-sm border-l-4",style:{borderLeftColor:t.color},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 rounded-full shadow-md",style:{backgroundColor:t.color}}),e.jsx("h3",{className:"font-bold text-base sm:text-lg text-gray-900 dark:text-white",children:t.title})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold ${d?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:[r.length,t.limit&&e.jsxs("span",{className:"text-xs ml-1",children:["/ ",t.limit]})]})})]})}),e.jsx(Ae,{droppableId:t.status,children:(h,u)=>e.jsxs("div",{ref:h.innerRef,...h.droppableProps,className:`flex-1 space-y-2 sm:space-y-3 p-2 sm:p-3 md:p-4 rounded-lg md:rounded-xl transition-all duration-200 overflow-y-auto ${u.isDraggingOver?"bg-blue-100/50 dark:bg-blue-900/30 border-2 border-blue-400 dark:border-blue-500 shadow-inner":"bg-white/50 dark:bg-gray-800/30 border-2 border-gray-200 dark:border-gray-700"}`,style:{minHeight:"350px"},children:[r.map((g,f)=>e.jsx(I,{ticket:g,index:f,onTicketClick:S},g.id)),h.placeholder,r.length===0&&!u.isDraggingOver&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(Me,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"No tickets"}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"Drag tickets here"})]})]})})]},t.id)})})})})})}function qe(){const y=Ve(),[o,S]=l.useState(""),[c,j]=l.useState(""),[x,k]=l.useState(""),[p,T]=l.useState(""),[I,t]=l.useState([]),[r,d]=l.useState(new Set),[h,u]=l.useState(!1),[g,f]=l.useState(""),[D,_]=l.useState(""),[N,z]=l.useState(""),[R,H]=l.useState(!1),[K,J]=l.useState(!1),[se,Q]=l.useState(!1),[U,te]=l.useState(()=>{const s=localStorage.getItem("ticketsViewMode");return s==="kanban"||s==="list"?s:"list"}),W=s=>{te(s),localStorage.setItem("ticketsViewMode",s)},[v,B]=l.useState(1),P=10,{tickets:A,isLoading:ae,error:Y,fetchTickets:w}=pe(),re=ue(ae,2e3);l.useEffect(()=>{const s=localStorage.getItem("user");if(s){const a=JSON.parse(s);a.role!=="ADMIN"&&a.role!=="TECHNICIAN"&&y("/my-tickets")}},[y]),l.useEffect(()=>{(async()=>{try{const a=await he();t(a)}catch(a){console.error("Error fetching users:",a)}})()},[]),l.useEffect(()=>{w({status:o,priority:c})},[o,c,w]),l.useEffect(()=>{B(1)},[o,c,x,p]);const m=l.useMemo(()=>A.filter(s=>{var n,b;const a=p===""||s.title.toLowerCase().includes(p.toLowerCase())||((n=s.number)==null?void 0:n.toLowerCase().includes(p.toLowerCase()))||((b=s.description)==null?void 0:b.toLowerCase().includes(p.toLowerCase())),i=x===""||x==="unassigned"&&!s.assignedToId||s.assignedToId===x;return a&&i}),[A,p,x]),{totalPages:F,paginatedTickets:M,startIndex:le,endIndex:ie}=l.useMemo(()=>{const s=Math.ceil(m.length/P),a=(v-1)*P,i=a+P,n=m.slice(a,i);return{totalPages:s,paginatedTickets:n,startIndex:a,endIndex:i}},[m,v,P]),G=l.useCallback(()=>{S(""),j(""),k(""),T("")},[]),ne=l.useCallback(async(s,a)=>{var i,n;try{const b=L();console.log("Updating ticket:",s,"to status:",a);const C=await b.patch(`/tickets/${s}`,{status:a});console.log("Update response:",C.data),await w({status:o,priority:c}),V("Status updated successfully")}catch(b){console.error("Status update error:",b);const C=((n=(i=b.response)==null?void 0:i.data)==null?void 0:n.message)||b.message||"Unknown error";throw $("Failed to update ticket status",C),b}},[w,o,c]);if(re)return e.jsx(be,{message:"Loading tickets..."});if(Y)return e.jsxs("div",{className:"p-8 text-red-600 dark:text-red-400 bg-gray-50 dark:bg-gray-900 min-h-screen",children:["Error: ",Y]});const X=s=>{switch(s){case"critical":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";case"high":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"low":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},q=s=>{switch(s){case"open":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"in_progress":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";case"closed":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},de=s=>{if(s.target.checked){const a=new Set(m.map(i=>i.id));d(a)}else d(new Set)},Z=s=>{const a=new Set(r);a.has(s)?a.delete(s):a.add(s),d(a)},oe=async()=>{if(r.size===0){await O({title:"No Tickets Selected",text:"Please select at least one ticket",icon:"warning",confirmButtonColor:"#3B82F6"});return}if(!g&&!D&&!N){await O({title:"No Updates Selected",text:"Please select at least one field to update",icon:"warning",confirmButtonColor:"#3B82F6"});return}H(!0);try{const s={};g&&(s.status=g),D&&(s.priority=D),N&&(s.assignedToId=N==="unassign"?null:N),await L().patch("/tickets/bulk",{ticketIds:Array.from(r),updates:s}),await V("Success!",`Successfully updated ${r.size} ticket(s)!`,2e3),d(new Set),u(!1),f(""),_(""),z(""),w({status:o,priority:c})}catch(s){await $("Error","Failed to update tickets"),console.error("Bulk update error:",s)}finally{H(!1)}},ce=async()=>{if(r.size===0){await O({title:"No Tickets Selected",text:"Please select at least one ticket",icon:"warning",confirmButtonColor:"#3B82F6"});return}if((await ye("Delete Tickets?",`Are you sure you want to delete ${r.size} ticket(s)? This action cannot be undone.`,"Yes, delete them","Cancel")).isConfirmed){J(!0);try{await L().delete("/tickets/bulk",{data:{ticketIds:Array.from(r)}}),await V("Deleted!",`Successfully deleted ${r.size} ticket(s)!`,2e3),d(new Set),u(!1),w({status:o,priority:c})}catch(a){await $("Error","Failed to delete tickets"),console.error("Bulk delete error:",a)}finally{J(!1)}}},xe=()=>{try{const s=m.length>0?m:A,a=we("tickets_export","csv");je(s,ke,a),E.success(`Exported ${s.length} tickets to CSV`)}catch(s){console.error("Export failed:",s),E.error("Failed to export tickets")}},me=()=>{try{Ne(ve,"ticket_import_template.csv"),E.success("Import template downloaded successfully")}catch(s){console.error("Template download failed:",s),E.error("Failed to download template")}},ge=async s=>{const a=localStorage.getItem("user"),i=a?JSON.parse(a):null;if(!i||!i.id)throw new Error("User not found. Please login again.");const n=new FormData;n.append("file",s),n.append("createdById",i.id),localStorage.getItem("token");const C=(await L().post("/tickets/import-csv",n,{headers:{"Content-Type":"multipart/form-data"}})).data;return await w({status:o,priority:c}),C};return e.jsxs("div",{className:"flex flex-col p-3 sm:p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex-shrink-0",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:"Ticket Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Manage and track support tickets"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-3 flex-1",children:[e.jsxs("button",{onClick:me,className:"px-3 sm:px-4 py-2 min-h-[44px] bg-purple-600 dark:bg-purple-500 text-white rounded-lg hover:bg-purple-700 dark:hover:bg-purple-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base",title:"Download CSV template for bulk import",children:[e.jsx(Le,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Template"})]}),e.jsxs("button",{onClick:()=>Q(!0),className:"px-3 sm:px-4 py-2 min-h-[44px] bg-indigo-600 dark:bg-indigo-500 text-white rounded-lg hover:bg-indigo-700 dark:hover:bg-indigo-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base",title:"Import tickets from CSV",children:[e.jsx(Ee,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Import CSV"})]}),e.jsxs("button",{onClick:xe,disabled:A.length===0,className:"px-3 sm:px-4 py-2 min-h-[44px] bg-green-600 dark:bg-green-500 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-600 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm sm:text-base",title:"Export tickets to CSV",children:[e.jsx(Ue,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Export CSV"})]}),e.jsxs("button",{onClick:()=>y("/tickets/new"),className:"px-3 sm:px-4 py-2 min-h-[44px] bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 flex items-center justify-center gap-2 transition-colors text-sm sm:text-base",children:[e.jsx("span",{children:"+"})," ",e.jsx("span",{className:"truncate",children:"New Ticket"})]})]}),e.jsxs("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>W("list"),className:`px-3 sm:px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${U==="list"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,title:"List View",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"List"})]}),e.jsxs("button",{onClick:()=>W("kanban"),className:`px-3 sm:px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${U==="kanban"?"bg-white dark:bg-gray-600 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,title:"Kanban View",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Kanban"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 md:mb-8 flex-shrink-0",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Tickets"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-gray-900 dark:text-white",children:m.length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"Open"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-blue-600 dark:text-blue-400",children:m.filter(s=>s.status==="open").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"In Progress"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-purple-600 dark:text-purple-400",children:m.filter(s=>s.status==="in_progress").length})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-5 md:p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-500 dark:text-gray-400",children:"High Priority"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1 sm:mt-2 text-red-600 dark:text-red-400",children:m.filter(s=>s.priority==="high"||s.priority==="critical").length})]})]}),e.jsx("div",{className:"mb-4 sm:mb-6 flex-shrink-0",role:"search",children:e.jsx("input",{type:"search",placeholder:"Search tickets by title, number, or description...",value:p,onChange:s=>T(s.target.value),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:text-white text-sm sm:text-base min-h-[44px]","aria-label":"Search tickets by title, ticket number, or description"})}),e.jsxs("div",{className:"mb-4 sm:mb-6 flex gap-2 sm:gap-4 items-center flex-wrap flex-shrink-0",children:[e.jsxs("select",{value:o,onChange:s=>S(s.target.value),className:"min-h-[44px] px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-gray-200 text-sm sm:text-base flex-1 sm:flex-initial min-w-[120px]",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("select",{value:c,onChange:s=>j(s.target.value),className:"min-h-[44px] px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-gray-200 text-sm sm:text-base flex-1 sm:flex-initial min-w-[120px]",children:[e.jsx("option",{value:"",children:"All Priority"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsxs("select",{value:x,onChange:s=>k(s.target.value),className:"min-h-[44px] px-3 sm:px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-gray-200 text-sm sm:text-base flex-1 sm:flex-initial min-w-[120px]",children:[e.jsx("option",{value:"",children:"All Assignees"}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),I.map(s=>e.jsx("option",{value:s.id,children:s.name||s.email},s.id))]}),e.jsxs("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),G()},disabled:!o&&!c&&!x&&!p,className:"min-h-[44px] px-3 sm:px-4 py-2 text-xs sm:text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors border border-gray-300 dark:border-gray-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 whitespace-nowrap",children:["Clear",(o||c||x||p)&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded-full font-semibold",children:[o,c,x,p].filter(Boolean).length})]}),r.size>0&&e.jsxs("button",{onClick:()=>u(!h),className:"ml-auto px-3 sm:px-4 py-2 min-h-[44px] bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm sm:text-base whitespace-nowrap",children:["Bulk Actions (",r.size,")"]})]}),h&&r.size>0&&e.jsxs("div",{className:"mb-6 bg-purple-50 dark:bg-purple-900/50 border border-purple-200 dark:border-purple-700 rounded-lg p-4 flex-shrink-0",children:[e.jsxs("h3",{className:"font-semibold mb-3 dark:text-white",children:["Update ",r.size," selected ticket(s)"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("select",{value:g,onChange:s=>f(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"Status (no change)"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("select",{value:D,onChange:s=>_(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"Priority (no change)"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]}),e.jsxs("select",{value:N,onChange:s=>z(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"",children:"Assignee (no change)"}),e.jsx("option",{value:"unassign",children:"Unassign"}),I.map(s=>e.jsx("option",{value:s.id,children:s.name||s.email},s.id))]}),e.jsx("button",{onClick:oe,disabled:R,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 flex items-center gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"sr-only",children:"Updating"})]}):"Apply Changes"})]}),e.jsx("div",{className:"flex justify-end border-t border-purple-200 dark:border-purple-700 pt-4",children:e.jsx("button",{onClick:ce,disabled:K,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 flex items-center gap-2",children:K?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"sr-only",children:"Deleting"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),`Delete Selected (${r.size})`]})})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:m.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-12 rounded-lg shadow text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tickets found"}),(o||c||x||p)&&e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),G()},className:"mt-4 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline",children:"Clear all filters"})]}):U==="kanban"?e.jsx($e,{tickets:m,onStatusChange:ne,onTicketClick:s=>y(`/tickets/${s}`)}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden space-y-4 pb-4 flex-1",children:M.map(s=>{var a,i,n;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:r.has(s.id),onChange:()=>Z(s.id),className:"w-5 h-5 mt-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:s.number||s.id}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.title})]})]})}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status:"}),e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${q(s.status||"")}`,children:(a=s.status)==null?void 0:a.replace("_"," ")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Priority:"}),e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${X(s.priority||"")}`,children:s.priority})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Assigned To:"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-300",children:((i=s.assignedTo)==null?void 0:i.name)||((n=s.assignedTo)==null?void 0:n.email)||"Unassigned"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created:"}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-300",children:ee(s.createdAt)})]})]}),e.jsx("button",{onClick:()=>y(`/tickets/${s.id}`),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium min-h-[44px]",children:"View Details"})]},s.id)})}),e.jsx("div",{className:"hidden md:block bg-white dark:bg-gray-800 rounded-lg shadow flex-1",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 dark:from-gray-700 dark:via-gray-700 dark:to-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("label",{className:"flex items-center justify-center min-w-[44px] min-h-[44px] cursor-pointer",children:e.jsx("input",{type:"checkbox",checked:r.size===M.length&&M.length>0,onChange:de,className:"w-5 h-5 cursor-pointer","aria-label":"Select all tickets"})})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Ticket #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Assigned To"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-900 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:M.map(s=>{var a,i,n;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("label",{className:"flex items-center justify-center min-w-[44px] min-h-[44px] cursor-pointer",children:e.jsx("input",{type:"checkbox",checked:r.has(s.id),onChange:()=>Z(s.id),className:"w-5 h-5 cursor-pointer","aria-label":`Select ticket ${s.number||s.id}`})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.number||s.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm dark:text-gray-300",children:s.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${q(s.status||"")}`,children:(a=s.status)==null?void 0:a.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${X(s.priority||"")}`,children:s.priority})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:((i=s.assignedTo)==null?void 0:i.name)||((n=s.assignedTo)==null?void 0:n.email)||"Unassigned"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:ee(s.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>y(`/tickets/${s.id}`),className:"text-blue-600 hover:text-blue-900",children:"View"})})]},s.id)})})]})}),m.length>0&&e.jsxs("div",{className:"mt-6 flex items-center justify-between bg-white dark:bg-gray-800 px-4 py-3 rounded-lg shadow border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:e.jsxs("span",{children:["Showing ",e.jsx("span",{className:"font-semibold",children:le+1})," to"," ",e.jsx("span",{className:"font-semibold",children:Math.min(ie,m.length)})," of"," ",e.jsx("span",{className:"font-semibold",children:m.length})," tickets"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>B(s=>Math.max(1,s-1)),disabled:v===1,className:"px-4 py-2 min-h-[44px] bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-400 transition-all shadow-md hover:shadow-lg flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Previous"]}),e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsxs("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Page ",v," of ",F]})}),e.jsxs("button",{onClick:()=>B(s=>Math.min(F,s+1)),disabled:v===F,className:"px-4 py-2 min-h-[44px] bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-400 transition-all shadow-md hover:shadow-lg flex items-center gap-2",children:["Next",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})]})]})}),e.jsx(fe,{isOpen:se,onClose:()=>Q(!1),onImport:ge,title:"Import Tickets from CSV",entityType:"tickets"})]})}export{qe as default};
