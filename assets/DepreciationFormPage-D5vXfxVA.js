import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as D,h as w,r as u}from"./vendor-react-CFQdvhEG.js";import{u as S,a as p,L}from"./index-DQDJZcqg.js";import{showError as l,showSuccess as x}from"./sweetalert-DcBwdyhg.js";import"./vendor-ui-Bhgb65c8.js";const E=()=>{const g=D(),{id:o}=w(),n=!!o,[m,d]=u.useState(!1),f=S(m,2e3),[b,y]=u.useState([]),[a,h]=u.useState({assetId:"",depreciationMethod:"straight_line",purchasePrice:"",salvageValue:"0",usefulLifeYears:"",usefulLifeMonths:"0",purchaseDate:"",depreciationStartDate:"",annualDepreciationRate:"",notes:""});u.useEffect(()=>{j(),n&&v()},[o]);const j=async()=>{try{const s=await p().get("/assets",{params:{status:"active",limit:1e3}});y(s.data.assets||[])}catch(s){console.error("Error loading assets:",s),l("Failed to load assets")}},v=async()=>{var s;try{d(!0);const r=(await p().get(`/depreciation/${o}`)).data;h({assetId:r.assetId,depreciationMethod:r.depreciationMethod,purchasePrice:r.purchasePrice.toString(),salvageValue:r.salvageValue.toString(),usefulLifeYears:r.usefulLifeYears.toString(),usefulLifeMonths:r.usefulLifeMonths.toString(),purchaseDate:new Date(r.purchaseDate).toISOString().split("T")[0],depreciationStartDate:new Date(r.depreciationStartDate).toISOString().split("T")[0],annualDepreciationRate:((s=r.annualDepreciationRate)==null?void 0:s.toString())||"",notes:r.notes||""})}catch(i){console.error("Error loading depreciation:",i),l("Failed to load depreciation record")}finally{d(!1)}},N=async s=>{var i,r;if(s.preventDefault(),!a.assetId||!a.purchasePrice||!a.usefulLifeYears||!a.purchaseDate||!a.depreciationStartDate){l("Please fill in all required fields");return}if(a.depreciationMethod==="declining_balance"&&!a.annualDepreciationRate){l("Annual depreciation rate is required for declining balance method");return}try{d(!0),n?(await p().put(`/depreciation/${o}`,a),x("Depreciation record updated successfully")):(await p().post("/depreciation",a),x("Depreciation record created successfully")),g("/depreciation")}catch(c){console.error("Error saving depreciation:",c),l(((r=(i=c.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to save depreciation record")}finally{d(!1)}},t=s=>{const{name:i,value:r}=s.target;h(c=>({...c,[i]:r}))};return f&&n?e.jsx(L,{message:"Loading depreciation record"}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:n?"Edit Depreciation":"Add Asset Depreciation"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Configure depreciation settings for an asset"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Asset Information"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Asset ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"assetId",value:a.assetId,onChange:t,required:!0,disabled:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select an asset"}),b.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.asset_code,")"]},s.id))]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Depreciation Method"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"depreciationMethod",value:a.depreciationMethod,onChange:t,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"straight_line",children:"Straight Line"}),e.jsx("option",{value:"declining_balance",children:"Declining Balance"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a.depreciationMethod==="straight_line"?"Equal depreciation amount each period":"Higher depreciation in early years, decreasing over time"})]}),a.depreciationMethod==="declining_balance"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Annual Depreciation Rate (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"annualDepreciationRate",value:a.annualDepreciationRate,onChange:t,step:"0.01",min:"0",max:"100",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 20 for 20%"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Financial Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Purchase Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"purchasePrice",value:a.purchasePrice,onChange:t,step:"0.01",min:"0",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salvage Value"}),e.jsx("input",{type:"number",name:"salvageValue",value:a.salvageValue,onChange:t,step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Estimated value at end of useful life"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Useful Life"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Years ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"usefulLifeYears",value:a.usefulLifeYears,onChange:t,min:"0",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Months"}),e.jsx("input",{type:"number",name:"usefulLifeMonths",value:a.usefulLifeMonths,onChange:t,min:"0",max:"11",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Important Dates"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Purchase Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"purchaseDate",value:a.purchaseDate,onChange:t,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Depreciation Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"depreciationStartDate",value:a.depreciationStartDate,onChange:t,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",value:a.notes,onChange:t,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional notes about this depreciation..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>g("/depreciation"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:m?"Saving...":n?"Update Depreciation":"Create Depreciation"})]})]})]})};export{E as default};
