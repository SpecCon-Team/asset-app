import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as O,k as S,r as o,L as E}from"./vendor-react-CFQdvhEG.js";import{ag as C,$ as D,z as d}from"./vendor-ui-Bhgb65c8.js";import{B as b,a as y}from"./index-BJREwX_9.js";function M(){var p;const u=O(),l=((p=S().state)==null?void 0:p.email)||"",[c,m]=o.useState(["","","","","",""]),[g,f]=o.useState(!1),[x,h]=o.useState(!1),i=o.useRef([]);o.useEffect(()=>{var s;(s=i.current[0])==null||s.focus()},[]),o.useEffect(()=>{l||u("/signup")},[l,u]);const j=(s,a)=>{var r;if(!/^\d*$/.test(a))return;const t=[...c];t[s]=a,m(t),a&&s<5&&((r=i.current[s+1])==null||r.focus())},k=(s,a)=>{var t;a.key==="Backspace"&&!c[s]&&s>0&&((t=i.current[s-1])==null||t.focus())},v=s=>{var n;s.preventDefault();const a=s.clipboardData.getData("text").slice(0,6);if(!/^\d+$/.test(a))return;const t=a.split("");for(;t.length<6;)t.push("");m(t);const r=Math.min(a.length,5);(n=i.current[r])==null||n.focus()},w=async s=>{var t,r;s.preventDefault();const a=c.join("");if(a.length!==6){d.error("Please enter complete OTP code");return}f(!0);try{const n=await y().post("/auth/verify-otp",{email:l,otp:a});d.success("Email verified successfully!"),localStorage.setItem("token",n.data.token),localStorage.setItem("user",JSON.stringify(n.data.user)),setTimeout(()=>{u("/")},1e3)}catch(n){const P=((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message||"Verification failed. Please try again.";d.error(P)}finally{f(!1)}},N=async()=>{var s,a,t;h(!0);try{await y().post("/auth/resend-otp",{email:l}),d.success("New OTP sent to your email!"),m(["","","","","",""]),(s=i.current[0])==null||s.focus()}catch(r){const n=((t=(a=r.response)==null?void 0:a.data)==null?void 0:t.message)||r.message||"Failed to resend OTP. Please try again.";d.error(n)}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex w-16 h-16 rounded-full items-center justify-center mb-4",style:{backgroundColor:"var(--color-primary)"},children:e.jsx(C,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Verify Your Email"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Enter the 6-digit code sent to"}),e.jsx("p",{className:"text-blue-600 dark:text-blue-400 font-medium",children:l})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8",children:[e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-4 text-center",children:"Enter Verification Code"}),e.jsx("div",{className:"flex gap-2 justify-center",onPaste:v,children:c.map((s,a)=>e.jsx("input",{ref:t=>i.current[a]=t,type:"text",inputMode:"numeric",maxLength:1,value:s,onChange:t=>j(a,t.target.value),onKeyDown:t=>k(a,t),className:"w-12 h-14 text-center text-2xl font-bold border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},a))})]}),e.jsx("button",{type:"submit",disabled:g||c.join("").length!==6,className:"w-full flex items-center justify-center gap-2 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:g?e.jsxs(e.Fragment,{children:[e.jsx(b,{})," Verifying..."]}):"Verify Email"})]}),e.jsxs("div",{className:"mt-6 text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Didn't receive the code?"}),e.jsx("button",{onClick:N,disabled:x,className:"inline-flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium disabled:opacity-50",children:x?e.jsxs(e.Fragment,{children:[e.jsx(b,{})," Sending..."]}):"Resend OTP"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(E,{to:"/signup",className:"inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:[e.jsx(D,{className:"w-4 h-4"}),"Back to Sign Up"]})}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:"The verification code is valid for 10 minutes. Check your spam folder if you don't see the email."})})]})]})})}export{M as default};
