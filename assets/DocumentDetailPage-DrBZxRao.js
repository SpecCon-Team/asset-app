import{m as w,u as D,r as o,h as C,f as i,j as e,L as k,I as L,e as S}from"./index-Pd9IxwbI.js";import{showError as c,showConfirmDialog as B,showSuccess as h}from"./sweetalert-BCvQYi5m.js";const F=()=>{const{id:l}=w(),m=D(),[t,p]=o.useState(null),[y,x]=o.useState(!0),j=C(y,2e3),[d,u]=o.useState("");o.useEffect(()=>{g()},[l]);const g=async()=>{try{x(!0);const s=await i().get(`/documents/${l}`);p(s.data)}catch(s){console.error("Error loading document:",s),c("Failed to load document")}finally{x(!1)}},N=async()=>{try{window.open(`${S()}/documents/${l}/download`,"_blank")}catch{c("Failed to download document")}},f=async()=>{var a,n;if(await B("Delete Document","Are you sure you want to delete this document? This action cannot be undone."))try{await i().delete(`/documents/${l}`),h("Document deleted successfully"),m("/documents")}catch(r){console.error("Error deleting document:",r),c(((n=(a=r.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to delete document")}},b=async s=>{if(s.preventDefault(),!!d.trim())try{await i().post(`/documents/${l}/comments`,{comment:d}),u(""),g(),h("Comment added successfully")}catch(a){console.error("Error adding comment:",a),c("Failed to add comment")}},v=s=>{const a=["B","KB","MB","GB"];let n=s,r=0;for(;n>=1024&&r<a.length-1;)n/=1024,r++;return`${n.toFixed(2)} ${a[r]}`};return j?e.jsx(k,{message:"Loading document details"}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>m("/documents"),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t.originalFileName})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Download"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Document Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"File Size"}),e.jsx("p",{className:"text-base font-medium text-gray-900 mt-1",children:v(t.fileSize)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Type"}),e.jsx("p",{className:"text-base font-medium text-gray-900 mt-1",children:t.mimeType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Version"}),e.jsx("p",{className:"text-base font-medium text-gray-900 mt-1",children:t.version})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Uploaded By"}),e.jsx("p",{className:"text-base font-medium text-gray-900 mt-1",children:t.uploadedBy.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Upload Date"}),e.jsx("p",{className:"text-base font-medium text-gray-900 mt-1",children:new Date(t.createdAt).toLocaleString()})]}),t.category&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Category"}),e.jsx("p",{className:"text-base font-medium mt-1 inline-block px-3 py-1 rounded-full",style:{backgroundColor:t.category.color+"30",color:t.category.color},children:t.category.name})]})]}),t.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:t.description})]}),t.tags&&t.tags.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((s,a)=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:s},a))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Comments (",t.comments.length,")"]}),e.jsxs("form",{onSubmit:b,className:"space-y-3",children:[e.jsx("textarea",{value:d,onChange:s=>u(s.target.value),rows:3,placeholder:"Add a comment...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Comment"})]}),e.jsx("div",{className:"space-y-3 mt-6",children:t.comments.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No comments yet"}):t.comments.map(s=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.user.name}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.createdAt).toLocaleString()})]}),e.jsx("p",{className:"text-gray-700",children:s.comment})]},s.id))})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Document not found"}),e.jsx(L,{to:"/documents",className:"text-blue-600 hover:underline mt-4 inline-block",children:"Back to Documents"})]})};export{F as default};
