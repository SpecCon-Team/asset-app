import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as F,r as i}from"./vendor-react-CFQdvhEG.js";import{u as V}from"./store-CvGvBtmy.js";import{u as R,L as B,f as H}from"./index-BQg6k2HC.js";import{A as k,c as o,O}from"./vendor-ui-Bhgb65c8.js";import"./types-D8_qC6eW.js";function K(){const m=F(),{tickets:A,isLoading:C,error:f,fetchTickets:j}=V(),I=R(C,2e3),[r]=i.useState(()=>{const t=localStorage.getItem("user");return t?JSON.parse(t):null}),[s,l]=i.useState("all"),[a,N]=i.useState(!1),[c,h]=i.useState(1),p=10;i.useEffect(()=>{j()},[j]),i.useEffect(()=>{h(1)},[s,a]);const u=A.filter(t=>r?r.role==="ADMIN"?!0:r.role==="TECHNICIAN"&&t.assignedToId===r.id||t.createdById===r.id:!1),g=new Date;g.setDate(g.getDate()-30);const D=u.filter(t=>t.createdAt?new Date(t.createdAt)>=g:!0),v=u.filter(t=>t.createdAt?new Date(t.createdAt)<g:!1),d=a?v:D;if(I)return e.jsx(B,{message:"Loading your tickets..."});if(f)return e.jsxs("div",{className:"p-8 text-red-600 dark:text-red-400 bg-gray-50 dark:bg-gray-900 min-h-screen",children:["Error: ",f]});const M=d.filter(t=>t.status==="open").length,S=d.filter(t=>t.status==="in_progress").length,P=d.filter(t=>t.status==="closed").length,L=d.length,w=v.length,n=d.filter(t=>s==="all"?!0:t.status===s),b=Math.ceil(n.length/p),y=(c-1)*p,T=y+p,E=n.slice(y,T),_=t=>{switch(t){case"critical":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";case"high":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"low":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},$=t=>{switch(t){case"open":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"in_progress":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";case"closed":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}};return e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-8 flex flex-col",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-start flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.role)==="ADMIN"?"All Tickets":(r==null?void 0:r.role)==="TECHNICIAN"?"Assigned Tickets":"My Tickets"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:(r==null?void 0:r.role)==="ADMIN"?"View and manage all support tickets":(r==null?void 0:r.role)==="TECHNICIAN"?"View tickets assigned to you":"Track your support requests"})]}),w>0&&e.jsxs("button",{onClick:()=>{N(!a),l("all")},className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${a?"bg-gray-600 text-white border-gray-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{children:a?"View Active Tickets":`View Archived (${w})`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8 flex-shrink-0",children:[e.jsxs("div",{onClick:()=>l("open"),className:`bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer transition-all hover:shadow-lg hover:scale-105 ${s==="open"?"ring-2 ring-blue-600 ring-offset-2 bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Open"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:M})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(o,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]}),s==="open"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:"Active Filter"})})]}),e.jsxs("div",{onClick:()=>l("in_progress"),className:`bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer transition-all hover:shadow-lg hover:scale-105 ${s==="in_progress"?"ring-2 ring-purple-600 ring-offset-2 bg-purple-50 dark:bg-purple-900/20":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"In Progress"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400 mt-2",children:S})]}),e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-full",children:e.jsx(o,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})})]}),s==="in_progress"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-purple-200 dark:border-purple-800",children:e.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium",children:"Active Filter"})})]}),e.jsxs("div",{onClick:()=>l("closed"),className:`bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer transition-all hover:shadow-lg hover:scale-105 ${s==="closed"?"ring-2 ring-green-600 ring-offset-2 bg-green-50 dark:bg-green-900/20":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-2",children:P})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-full",children:e.jsx(o,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]}),s==="closed"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-800",children:e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:"Active Filter"})})]}),e.jsxs("div",{onClick:()=>l("all"),className:`bg-white dark:bg-gray-800 rounded-lg shadow p-6 cursor-pointer transition-all hover:shadow-lg hover:scale-105 ${s==="all"?"ring-2 ring-gray-600 ring-offset-2 bg-gray-50 dark:bg-gray-700/20":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-2",children:L})]}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded-full",children:e.jsx(o,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})})]}),s==="all"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:"Showing All"})})]})]}),a&&e.jsxs("div",{className:"mb-6 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg p-4 flex items-center gap-3 flex-shrink-0",children:[e.jsx(k,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Viewing Archived Tickets"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:"Showing tickets older than 30 days"})]})]}),e.jsxs("div",{className:"mb-6 flex justify-between items-center flex-shrink-0",children:[!a&&(r==null?void 0:r.role)!=="ADMIN"&&e.jsx("button",{onClick:()=>m("/tickets/new"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"+ New Ticket"}),s!=="all"&&e.jsxs("div",{className:"flex items-center gap-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg px-4 py-2",children:[e.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Filtered by: ",e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:s==="open"?"Open Tickets":s==="in_progress"?"In Progress Tickets":s==="closed"?"Completed Tickets":"All Tickets"})]}),e.jsxs("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),l("all")},className:"ml-auto flex items-center gap-1 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",title:"Clear filter and show all tickets",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]})]}),e.jsx("div",{className:"flex-1",children:u.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center",children:[e.jsx(o,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:(r==null?void 0:r.role)==="ADMIN"?"No tickets in the system":(r==null?void 0:r.role)==="TECHNICIAN"?"No tickets assigned yet":"No tickets yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:(r==null?void 0:r.role)==="ADMIN"?"No support tickets have been created yet":(r==null?void 0:r.role)==="TECHNICIAN"?"You have no tickets assigned to you at the moment":"Create your first support ticket to get started"}),(r==null?void 0:r.role)!=="ADMIN"&&e.jsx("button",{onClick:()=>m("/tickets/new"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Ticket"})]}):d.length===0&&a?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center",children:[e.jsx(k,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No archived tickets"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"You don't have any tickets older than 30 days"}),e.jsx("button",{onClick:()=>N(!1),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"View Active Tickets"})]}):n.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center",children:[e.jsx(o,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:["No ",s==="open"?"open":s==="in_progress"?"in progress":s==="closed"?"completed":""," tickets found"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:s==="open"?"You don't have any open tickets at the moment":s==="in_progress"?"You don't have any tickets in progress":s==="closed"?"You don't have any completed tickets yet":"No tickets found"}),e.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),l("all")},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"View All Tickets"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:E.map(t=>{var x;return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>m(`/tickets/${t.id}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Ticket #",t.number||t.id]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${$(t.status||"")}`,children:(x=t.status)==null?void 0:x.replace("_"," ")}),e.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${_(t.priority||"")}`,children:t.priority})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-2",children:t.description||"No description"}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"space-x-4",children:[e.jsx("span",{children:t.status==="closed"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"Closed by: "}),t.assignedTo?t.assignedTo.name||t.assignedTo.email:"Technician"]}):e.jsxs(e.Fragment,{children:["Assigned to: ",t.assignedTo?t.assignedTo.name||t.assignedTo.email:e.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-medium",children:"Awaiting Assignment"})]})}),t.createdAt&&e.jsxs("span",{children:["Created: ",H(t.createdAt)]})]}),t.resolution&&t.status==="closed"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600 dark:text-green-400",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Resolved"})]})]})]},t.id)})}),n.length>0&&e.jsxs("div",{className:"mt-6 flex items-center justify-between bg-white dark:bg-gray-800 px-4 py-3 rounded-lg shadow border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:e.jsxs("span",{children:["Showing ",e.jsx("span",{className:"font-semibold",children:y+1})," to"," ",e.jsx("span",{className:"font-semibold",children:Math.min(T,n.length)})," of"," ",e.jsx("span",{className:"font-semibold",children:n.length})," tickets"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>h(t=>Math.max(1,t-1)),disabled:c===1,className:"px-4 py-2 min-h-[44px] bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-400 transition-all shadow-md hover:shadow-lg flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Previous"]}),e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:e.jsxs("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Page ",c," of ",b]})}),e.jsxs("button",{onClick:()=>h(t=>Math.min(b,t+1)),disabled:c===b,className:"px-4 py-2 min-h-[44px] bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-400 transition-all shadow-md hover:shadow-lg flex items-center gap-2",children:["Next",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})]})]})})]})})}export{K as default};
