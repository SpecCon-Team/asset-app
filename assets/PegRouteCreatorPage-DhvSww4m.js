import{j as e}from"./vendor-charts-DVp8BQgJ.js";import{u as P,r as l}from"./vendor-react-CFQdvhEG.js";import{showInfo as E,showError as m}from"./sweetalert-DcBwdyhg.js";import{u as S,j as L,a as F,L as R}from"./index-DQDJZcqg.js";import{$ as G,e as A,at as M,i as $,ad as B}from"./vendor-ui-Bhgb65c8.js";const h=[{id:"WC",name:"Western Cape",color:"#FF9800"},{id:"EC",name:"Eastern Cape",color:"#8D6E63"},{id:"NC",name:"Northern Cape",color:"#42A5F5"},{id:"FS",name:"Free State",color:"#FFC107"},{id:"KZN",name:"KwaZulu-Natal",color:"#616161"},{id:"NW",name:"North West",color:"#9E9E9E"},{id:"GP",name:"Gauteng",color:"#64B5F6"},{id:"MP",name:"Mpumalanga",color:"#3F51B5"},{id:"LP",name:"Limpopo",color:"#8BC34A"}];function Q(){const i=P(),[x,b]=l.useState([]),[o,p]=l.useState([]),[n,y]=l.useState(""),[c,v]=l.useState(""),[f,u]=l.useState(!0),j=S(f,2e3),t=L()==="PEG";l.useEffect(()=>{t&&(E("View Only","PEG users can view travel plans but cannot create new routes. Redirecting to Travel Plan..."),setTimeout(()=>{i("/travel-plan")},2e3))},[t,i]),l.useEffect(()=>{N()},[]);const N=async()=>{try{u(!0);const a=await F().get("/peg");b(a.data)}catch(r){console.error("Error loading PEG clients:",r),m("Error","Failed to load clients")}finally{u(!1)}},w=r=>{p(a=>a.includes(r)?a.filter(s=>s!==r):[...a,r])},g=x.filter(r=>{var d;const a=!n||r.name.toLowerCase().includes(n.toLowerCase())||r.location.toLowerCase().includes(n.toLowerCase())||((d=r.contactPerson)==null?void 0:d.toLowerCase().includes(n.toLowerCase())),s=!c||r.provinceId===c;return a&&s}),C=x.filter(r=>o.includes(r.id)),k=()=>{if(t){m("Access Denied","PEG users cannot create travel routes. Please contact an administrator.");return}if(o.length===0){m("No Clients Selected","Please select at least one client to create a route");return}const r=o.join(",");i(`/travel-plan/peg-route-editor?clients=${r}`)};return j?e.jsx(R,{message:"Loading clients..."}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>i("/travel-plan"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-4",children:[e.jsx(G,{className:"w-5 h-5"}),"Back to Travel Plan"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:t?"PEG Client Routes":"Create PEG Client Route"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t?"PEG users can view routes created by administrators":"Select clients from My PEG to create a travel route"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients by name, location, or contact...",value:n,onChange:r=>y(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("select",{value:c,onChange:r=>v(r.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Provinces"}),h.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]})}),o.length>0&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-300",children:[o.length," client",o.length!==1?"s":""," selected"]}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-400 mt-1",children:C.map(r=>r.name).join(", ")})]}),!t&&e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(M,{className:"w-5 h-5"}),"Create Route"]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Available Clients (",g.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g.length===0?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No clients found"})}):g.map(r=>{const a=o.includes(r.id),s=h.find(d=>d.id===r.provinceId);return e.jsx("div",{onClick:t?void 0:()=>w(r.id),className:`p-4 transition-colors ${t?"":"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50"} ${a?"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500":""}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[!t&&e.jsx("div",{className:`flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${a?"bg-blue-600 border-blue-600":"border-gray-300 dark:border-gray-600"}`,children:a&&e.jsx($,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r.name}),r.clientCode&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded",children:r.clientCode})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:r.location})]}),s&&e.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium text-white whitespace-nowrap",style:{backgroundColor:s.color},title:s.name,children:s.name})]}),(r.contactPerson||r.phone||r.email)&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[r.contactPerson&&e.jsxs("span",{children:["Contact: ",r.contactPerson]}),r.phone&&e.jsxs("span",{className:"ml-3",children:["Phone: ",r.phone]}),r.email&&e.jsxs("span",{className:"ml-3",children:["Email: ",r.email]})]})]})]})},r.id)})})]})]})}export{Q as default};
