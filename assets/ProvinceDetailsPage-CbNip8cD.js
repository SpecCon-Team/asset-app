import{c as D,l as L,u as B,r as n,f as q,e as h,j as e,U as j,L as W,k as $,i as G}from"./index-D8B7AIac.js";import{showError as m,showSuccess as u,showConfirm as T}from"./sweetalert-BCvQYi5m.js";import{A as U}from"./arrow-left-Cr30uiaR.js";import{P as N}from"./plus-whz59BuU.js";import{P as v}from"./phone-B46WmwRm.js";import{M as I}from"./map-pin-B_t5qnba.js";import{P as Z}from"./pen-CZD3elGk.js";import{M as z}from"./mail-BDI6YzoL.js";import{C as K}from"./calendar-D0RNAj50.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=D("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),V=[{id:"WC",name:"Western Cape",color:"#FF9800"},{id:"EC",name:"Eastern Cape",color:"#8D6E63"},{id:"NC",name:"Northern Cape",color:"#42A5F5"},{id:"FS",name:"Free State",color:"#FFC107"},{id:"KZN",name:"KwaZulu-Natal",color:"#616161"},{id:"NW",name:"North West",color:"#9E9E9E"},{id:"GP",name:"Gauteng",color:"#64B5F6"},{id:"MP",name:"Mpumalanga",color:"#3F51B5"},{id:"LP",name:"Limpopo",color:"#8BC34A"}];function ae(){const{provinceId:c}=L(),p=B(),[r,w]=n.useState([]),[C,b]=n.useState(!0),P=q(C,2e3),[E,i]=n.useState(!1),[x,y]=n.useState(null),[t,s]=n.useState({name:"",location:"",contactPerson:"",phone:"",email:""}),o=V.find(a=>a.id===c);n.useEffect(()=>{g()},[c]);const g=async()=>{try{b(!0);const l=(await h().get("/peg")).data.filter(S=>S.provinceId===c);w(l)}catch(a){console.error("Error loading clients:",a),m("Error","Failed to load clients")}finally{b(!1)}},f=()=>{i(!0),y(null),s({name:"",location:"",contactPerson:"",phone:"",email:""})},A=a=>{y(a),s({name:a.name,location:a.location,contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||""}),i(!0)},M=async a=>{if(a.preventDefault(),!t.name||!t.location){m("Validation Error","Name and Location are required");return}try{const d=h(),l={...t,provinceId:c};x?(await d.put(`/peg/${x.id}`,l),u("Success","Client updated successfully",2e3)):(await d.post("/peg",l),u("Success","Client added successfully",2e3)),i(!1),g()}catch(d){console.error("Error saving client:",d),m("Error","Failed to save client")}},F=async a=>{if((await T("Delete Client",`Are you sure you want to delete ${a.name}?`,"Yes, delete it","Cancel")).isConfirmed)try{await h().delete(`/peg/${a.id}`),u("Deleted","Client deleted successfully",2e3),g()}catch(l){console.error("Error deleting client:",l),m("Error","Failed to delete client")}};return o?e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>p("/my-peg"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-4 transition-colors",children:[e.jsx(U,{className:"w-5 h-5"}),"Back to My PEG"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center text-white text-2xl font-bold shadow-lg",style:{backgroundColor:o.color},children:o.id}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:o.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:[r.length," ",r.length===1?"Client":"Clients"]})]})]}),e.jsxs("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx(N,{className:"w-5 h-5"}),"Add Client"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"With Contact"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.filter(a=>a.phone||a.email).length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Contact Persons"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.filter(a=>a.contactPerson).length})]})]})})]}),P?e.jsx(W,{message:"Loading province details..."}):r.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-12 rounded-lg shadow-sm text-center border border-gray-200 dark:border-gray-700",children:[e.jsx(k,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Clients Yet"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Start by adding your first client to ",o.name]}),e.jsxs("button",{onClick:f,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Add First Client"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(a=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:o.color},children:a.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:a.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx(I,{className:"w-4 h-4"}),a.location]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(a),className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",title:"Edit Client",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>F(a),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Delete Client",children:e.jsx($,{className:"w-4 h-4"})})]})]}),a.contactPerson&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(j,{className:"w-4 h-4 text-gray-500"}),a.contactPerson]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500"}),e.jsx("a",{href:`tel:${a.phone}`,className:"hover:text-blue-600",children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(z,{className:"w-4 h-4 text-gray-500"}),e.jsx("a",{href:`mailto:${a.email}`,className:"hover:text-blue-600",children:a.email})]}),a.createdAt&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(K,{className:"w-4 h-4"}),"Added ",G(a.createdAt)]})]},a.id))}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x?"Edit Client":"Add New Client"}),e.jsxs("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{className:"sr-only",children:"Close"}),"Ã—"]})]}),e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Client Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.name,onChange:a=>s({...t,name:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., ABC Corporation",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.location,onChange:a=>s({...t,location:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., Cape Town",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Contact Person"}),e.jsx("input",{type:"text",value:t.contactPerson,onChange:a=>s({...t,contactPerson:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:t.phone,onChange:a=>s({...t,phone:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., +27 12 345 6789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:t.email,onChange:a=>s({...t,email:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., john@example.com"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[x?"Update":"Add"," Client"]})]})]})]})})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Province Not Found"}),e.jsx("button",{onClick:()=>p("/my-peg"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to My PEG"})]})}export{ae as default};
