import{r as d,j as e,z as n}from"./react-vendor-DE6j8A-W.js";import{u as w,L as k,a as C}from"./index-DXiG9VXC.js";import{ar as P,X as S,U as F,ae as U,ad as L,az as X,ab as D,ax as I}from"./ui-libs-QpcJ0xea.js";import"./export-libs-C_ZIqR8y.js";import"./vendor-DIIGlvtc.js";function B(){const[m,u]=d.useState(null),[t,c]=d.useState({name:"",email:"",phone:"",department:"",location:"",bio:"",profilePicture:""}),[h,g]=d.useState(!0),b=w(h,2e3),[x,p]=d.useState(!1);d.useEffect(()=>{const s=localStorage.getItem("user");if(s){const a=JSON.parse(s);u(a),c({name:a.name??"",email:a.email??"",phone:a.phone??"",department:a.department??"",location:a.location??"",bio:a.bio??"",profilePicture:a.profilePicture??""})}g(!1)},[]);const o=s=>{const{name:a,value:l}=s.target;c(r=>({...r,[a]:l}))},f=s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];if(a){if(a.size>2*1024*1024){n.error("Image size should be less than 2MB");return}if(!a.type.startsWith("image/")){n.error("Please upload an image file");return}const r=new FileReader;r.onloadend=()=>{const i=r.result;c(v=>({...v,profilePicture:i})),n.success('Profile picture updated! Click "Save Changes" to apply.')},r.readAsDataURL(a)}},y=()=>{c(s=>({...s,profilePicture:""})),n.success('Profile picture removed! Click "Save Changes" to apply.')},j=async s=>{var a,l;s.preventDefault(),p(!0);try{const r=await C().patch(`/users/${m.id}/profile`,t),i={...m,...t,...r.data||{}};localStorage.setItem("user",JSON.stringify(i)),u(i),window.dispatchEvent(new CustomEvent("userUpdated")),n.success("Profile updated successfully!")}catch(r){console.error("Failed to update profile:",r);const i=((l=(a=r.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to update profile";n.error(i)}finally{p(!1)}},N=()=>{var s;return t.name?t.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):((s=t.email)==null?void 0:s.slice(0,2).toUpperCase())||"U"};return b||!m?e.jsx(k,{message:"Loading profile..."}):e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"My Profile"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"Manage your personal information"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-32"}),e.jsxs("div",{className:"px-8 pb-8",children:[e.jsx("div",{className:"relative -mt-16 mb-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"mb-4 text-center",children:e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.name||"No Name"})}),e.jsxs("div",{className:"relative flex-shrink-0",children:[t.profilePicture?e.jsx("img",{src:t.profilePicture,alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-white shadow-lg object-cover"}):e.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-white shadow-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-4xl",children:N()})}),e.jsxs("label",{htmlFor:"profile-upload",className:"absolute bottom-0 right-0 bg-blue-600 rounded-full p-2 cursor-pointer hover:bg-blue-700 transition-colors shadow-lg",title:"Change profile picture",children:[e.jsx(P,{className:"w-5 h-5 text-white"}),e.jsx("input",{id:"profile-upload",type:"file",accept:"image/*",onChange:f,className:"hidden"})]}),t.profilePicture&&e.jsx("button",{type:"button",onClick:y,className:"absolute bottom-0 left-0 bg-red-600 rounded-full p-2 cursor-pointer hover:bg-red-700 transition-colors shadow-lg",title:"Remove profile picture",children:e.jsx(S,{className:"w-5 h-5 text-white"})})]})]})}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"name",name:"name",type:"text",value:t.name,onChange:o,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"email",name:"email",type:"email",value:t.email,onChange:o,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"john@example.com",disabled:!0})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"phone",name:"phone",type:"tel",value:t.phone,onChange:o,maxLength:10,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+27 (0XX) XXX-XXXX"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Maximum 10 digits"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Department"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"department",name:"department",type:"text",value:t.department,onChange:o,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Engineering"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Location"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:"location",name:"location",type:"text",value:t.location,onChange:o,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Johannesburg, South Africa"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"About"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Bio"}),e.jsx("textarea",{id:"bio",name:"bio",value:t.bio,onChange:o,rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Tell us about yourself..."}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[t.bio.length,"/500 characters"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:()=>window.history.back(),className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:x?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"sr-only",children:"Saving"})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:"Save Changes"})]})})]})]})]})]})]})}export{B as default};
