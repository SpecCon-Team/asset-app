import{r as n,j as e}from"./react-vendor-CGeGxK2Z.js";import{showError as g,showSuccess as h,showConfirm as L}from"./sweetalert-BqYQyfQ6.js";import{u as M,a as u,L as B,f as T}from"./index-C4sdeoft.js";import{b as W,u as $}from"./react-router-vendor-DDwJJgaM.js";import{ai as G,ah as f,aj as N,ad as v,U as k,ab as U,ag as q,T as I,ae as K,a2 as Y}from"./ui-libs-t3PztYli.js";import"./export-libs-_UL_8v9K.js";import"./vendor-U4Kn3po4.js";const Z=[{id:"WC",name:"Western Cape",color:"#FF9800"},{id:"EC",name:"Eastern Cape",color:"#8D6E63"},{id:"NC",name:"Northern Cape",color:"#42A5F5"},{id:"FS",name:"Free State",color:"#FFC107"},{id:"KZN",name:"KwaZulu-Natal",color:"#616161"},{id:"NW",name:"North West",color:"#9E9E9E"},{id:"GP",name:"Gauteng",color:"#64B5F6"},{id:"MP",name:"Mpumalanga",color:"#3F51B5"},{id:"LP",name:"Limpopo",color:"#8BC34A"}];function X(){const{provinceId:x}=W(),b=$(),[s,w]=n.useState([]),[C,p]=n.useState(!0),P=M(C,2e3),[E,i]=n.useState(!1),[c,y]=n.useState(null),[t,r]=n.useState({name:"",location:"",contactPerson:"",phone:"",email:"",clientCode:""}),d=Z.find(a=>a.id===x);n.useEffect(()=>{m()},[x]);const m=async()=>{try{p(!0);const l=(await u().get("/peg")).data.filter(D=>D.provinceId===x);w(l)}catch(a){console.error("Error loading clients:",a),g("Error","Failed to load clients")}finally{p(!1)}},j=()=>{i(!0),y(null),r({name:"",location:"",contactPerson:"",phone:"",email:"",clientCode:""})},A=a=>{y(a),r({name:a.name,location:a.location,contactPerson:a.contactPerson||"",phone:a.phone||"",email:a.email||"",clientCode:a.clientCode||""}),i(!0)},F=async a=>{if(a.preventDefault(),!t.name||!t.location){g("Validation Error","Name and Location are required");return}try{const o=u(),l={...t,provinceId:x};c?(await o.put(`/peg/${c.id}`,l),h("Success","Client updated successfully",2e3)):(await o.post("/peg",l),h("Success","Client added successfully",2e3)),i(!1),m()}catch(o){console.error("Error saving client:",o),g("Error","Failed to save client")}},S=async a=>{if((await L("Delete Client",`Are you sure you want to delete ${a.name}?`,"Yes, delete it","Cancel")).isConfirmed)try{await u().delete(`/peg/${a.id}`),h("Deleted","Client deleted successfully",2e3),m()}catch(l){console.error("Error deleting client:",l),g("Error","Failed to delete client")}};return d?e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>b("/my-peg"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-4 transition-colors",children:[e.jsx(G,{className:"w-5 h-5"}),"Back to My PEG"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center text-white text-2xl font-bold shadow-lg",style:{backgroundColor:d.color},children:d.id}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.name}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:[s.length," ",s.length===1?"Client":"Clients"]})]})]}),e.jsxs("button",{onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx(f,{className:"w-5 h-5"}),"Add Client"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"With Contact"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(a=>a.phone||a.email).length})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Contact Persons"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.filter(a=>a.contactPerson).length})]})]})})]}),P?e.jsx(B,{message:"Loading province details..."}):s.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-12 rounded-lg shadow-sm text-center border border-gray-200 dark:border-gray-700",children:[e.jsx(N,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Clients Yet"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Start by adding your first client to ",d.name]}),e.jsxs("button",{onClick:j,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5"}),"Add First Client"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(a=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold",style:{backgroundColor:d.color},children:a.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:a.name}),a.clientCode&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-xs font-mono",children:a.clientCode})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx(U,{className:"w-4 h-4"}),a.location]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(a),className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors",title:"Edit Client",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S(a),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:"Delete Client",children:e.jsx(I,{className:"w-4 h-4"})})]})]}),a.contactPerson&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(k,{className:"w-4 h-4 text-gray-500"}),a.contactPerson]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500"}),e.jsx("a",{href:`tel:${a.phone}`,className:"hover:text-blue-600",children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(K,{className:"w-4 h-4 text-gray-500"}),e.jsx("a",{href:`mailto:${a.email}`,className:"hover:text-blue-600",children:a.email})]}),a.createdAt&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(Y,{className:"w-4 h-4"}),"Added ",T(a.createdAt)]})]},a.id))}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:c?"Edit Client":"Add New Client"}),e.jsxs("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:[e.jsx("span",{className:"sr-only",children:"Close"}),"Ã—"]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Client Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.name,onChange:a=>r({...t,name:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., ABC Corporation",required:!0})]}),!c&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client Serial Number"}),e.jsx("input",{type:"text",value:t.clientCode||"",onChange:a=>r({...t,clientCode:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white font-mono",placeholder:"e.g., 2295PPB0001"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Location ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:t.location,onChange:a=>r({...t,location:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., Cape Town",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Contact Person"}),e.jsx("input",{type:"text",value:t.contactPerson,onChange:a=>r({...t,contactPerson:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:t.phone,onChange:a=>r({...t,phone:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., +27 12 345 6789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:t.email,onChange:a=>r({...t,email:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"e.g., john@example.com"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[c?"Update":"Add"," Client"]})]})]})]})})})]}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Province Not Found"}),e.jsx("button",{onClick:()=>b("/my-peg"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to My PEG"})]})}export{X as default};
