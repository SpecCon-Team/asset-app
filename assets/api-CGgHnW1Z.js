import{h as a,g as s}from"./index-e6x7aUYm.js";const i=()=>{if(typeof window>"u")return!1;const e=s(),t=new URL(e).origin,n=window.location.origin;return t!==n},c=a.create({baseURL:s(),withCredentials:!i()});function u(){if(i())return null;const e=document.cookie.split(";");for(const t of e){const[n,r]=t.trim().split("=");if(n==="csrfToken")return decodeURIComponent(r)}return null}async function l(){if(i())return null;try{return(await a.get(`${s()}/auth/csrf-token`,{withCredentials:!0})).data.csrfToken||null}catch(e){return console.warn("Failed to fetch CSRF token:",e),null}}c.interceptors.request.use(async e=>{var n,r;const t=localStorage.getItem("token");if(t&&(e.headers.Authorization=`Bearer ${t}`),!i()&&["POST","PUT","DELETE","PATCH"].includes(((n=e.method)==null?void 0:n.toUpperCase())||"")&&!((r=e.url)!=null&&r.includes("/auth/login"))){let o=u();o||(o=await l()),o&&(e.headers["X-CSRF-Token"]=o)}return e});export{c as a};
